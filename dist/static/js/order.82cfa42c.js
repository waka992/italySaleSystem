(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{"118a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-box"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[t._v("销售")]),a("el-breadcrumb-item",[t._v("销售订单")])],1)],1),a("div",{staticClass:"switch"},[a("div",{staticClass:"switch-item",class:0==t.selectedSwitch?"selected":"",on:{click:function(e){return t.switchSelect(0)}}},[t._v("全部订单")])]),a("el-button",{staticClass:"new-btn",attrs:{type:"primary"},on:{click:function(e){return t.showDialog("new")}}},[t._v("新订单")]),a("div",{staticClass:"box"},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"name-search",attrs:{size:"mini","suffix-icon":"el-icon-search",placeholder:"输入客户名"},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}}),a("div",{staticClass:"time"},[a("span",{staticClass:"label"},[t._v("时间")]),a("div",{staticClass:"time-comp"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1)]),a("div",{staticClass:"status"},[a("span",{staticClass:"label"},[t._v("审核状态")]),a("el-select",{attrs:{size:"mini",placeholder:"请选择",clearable:""},model:{value:t.process,callback:function(e){t.process=e},expression:"process"}},t._l(t.dict.verifyCheckStatus,(function(t,e){return a("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1)],1),a("el-button",{attrs:{size:"mini",icon:"el-icon-search"},on:{click:t.getData}})],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,stripe:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"customerName",label:"客户",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.timeFormat(e.row.createTime))+"\n                ")]}}])}),a("el-table-column",{attrs:{label:"订单状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.getDict(e.row.process,"verifyStatus")))]}}])}),a("el-table-column",{attrs:{prop:"caseNum",label:"箱数",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"金额",align:"center"}}),a("el-table-column",{attrs:{prop:"payStatus",label:"支付方式",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.getDict(e.row.payType,"accountType"))+"\n                ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"130",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.showDialog("edit",e.row.id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.showDialog("review",e.row.id)}}},[t._v("预览")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.cancelOrder(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.page.no,"page-size":t.page.size,"page-sizes":[5,10,20],total:t.page.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.basePageChange}})],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!1,title:"新订单",visible:t.baseDialogVisible,width:"830px"},on:{"update:visible":function(e){t.baseDialogVisible=e}}},[a("dialog-new-order",{ref:"newOrderDialog",on:{saveData:t.saveSubmit}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(e){t.baseDialogVisible=!1}}},[t._v("取消")]),a("el-button",{staticClass:"curr-btn",attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")])],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!1,title:"订单预览",visible:t.reviewDialogVisible,width:"830px"},on:{"update:visible":function(e){t.reviewDialogVisible=e}}},[a("dialog-review",{ref:"dialogReview",on:{getPDF:t.getReviewPDF}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(e){t.reviewDialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.askReviewPDF}},[t._v("生成PDF")])],1)],1)],1)},i=[],o=a("7609"),l=a("de9e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dialog-bill"},[a("div",{staticClass:"language"},[a("common-selector",{attrs:{width:"70px",placeholder:"请选择语言",options:[{label:"中文版本",value:"CN"},{label:"English",value:"EN"}]},on:{change:t.languageChange}})],1),a("div",{attrs:{id:"dialogReview"}},["CN"==t.language?a("div",{staticClass:"bill-form"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[t._v("订单日期")]),a("span",{staticClass:"value"},[t._v(t._s(t.form.date))])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[t._v("销售方")]),a("span",{staticClass:"value"},[t._v(t._s(t.form.seller))])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[t._v("订单状态")]),a("span",{staticClass:"value"},[t._v(t._s(t.getDict(t.form.process,"verifyStatus")))])])],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[t._v("客户名称")]),a("span",{staticClass:"value"},[t._v(t._s(t.form.name))])])],1)],1):t._e(),"EN"==t.language?a("div",{staticClass:"bill-form"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[t._v(t._s(t.labels.date))]),"CN"==t.language?a("span",{staticClass:"value"},[t._v(t._s(t.dateFormat(t.form.date,"CN")))]):a("span",{staticClass:"value"},[t._v(t._s(t.dateFormat(t.form.date,"EN")))])])],1),a("el-row"),a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[t._v(t._s(t.labels.customerName))]),a("span",{staticClass:"value"},[t._v(t._s(t.form.name))])])],1),a("el-row")],1):t._e(),t._l(t.tableList,(function(e,s){return a("div",{key:s,staticClass:"prod-table"},[a("div",{staticClass:"table-area"},[a("div",{staticClass:"table-head"},t._l(t.tableTitles,(function(e,s){return a("div",{key:s,staticClass:"head-item"},[t._v(t._s(e.label))])})),0),t._l(e.data,(function(e,s){return a("div",{key:s,staticClass:"table-list",class:s%2==0?"odd":"double"},[a("div",{staticClass:"list-item"},[t._v("\n                        "+t._s(e.specification)+"\n                    ")]),a("div",{staticClass:"list-item"},[t._v("\n                        "+t._s(e.caseNum)+"\n                    ")]),a("div",{staticClass:"list-item"},[t._v("\n                        "+t._s(e.goodsTotal)+"\n                    ")]),a("div",{staticClass:"list-item"},[t._v("\n                        "+t._s(e.goodsPrice)+"\n                    ")]),a("div",{staticClass:"list-item"},[t._v("\n                        "+t._s(e.caseNum*e.goodsTotal*e.goodsPrice||0)+"\n                        ")])])}))],2)])})),a("div",{staticClass:"total-statistics"},[a("div",{staticClass:"statistics-title"},[t._v("总汇：")]),a("div",{staticClass:"statistics-box"},[a("div",{staticClass:"statistics-inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.allTotalSum))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.total.value))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.totalBoxes))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.total.boxes))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.payType))]),"CN"==t.language?a("div",{staticClass:"item-value"},[t._v(t._s(t.getDict(t.total.payType,"accountType")))]):a("div",{staticClass:"item-value"},[t._v(t._s(t.getDict(t.total.payType,"accountTypeEN")))])])]),a("div",{staticClass:"statistics-inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.taxRate))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.total.taxRate))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.pieces))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.form.pieces))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.discount))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.total.discount))])])]),a("div",{staticClass:"statistics-inner"})])])],2)])},c=[],r=(a("c5f6"),a("85f2")),u=a.n(r);function m(t,e,a){return e in t?u()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var d=a("2ef0"),p=a("f74d"),f=a("9dcd"),v=a.n(f),g={name:"DialogBill",components:{CommonSelector:p["a"]},data:function(){var t;return{language:"CN",totalBoxes:2300,totalValue:2800,payStatus:0,form:{},labels:(t={customerName:"客户名称",date:"账单日期",supplier:"销售方",totalSum:"总金额",payStatus:"支付状态",totalBoxes:"总销售箱数",allTotalSum:"总金额"},m(t,"totalBoxes","总箱数"),m(t,"payType","支付方式"),m(t,"taxRate","税收"),m(t,"pieces","总件数"),m(t,"discount","折扣"),m(t,"discountValue","折扣金额"),m(t,"taxValue","税后金额"),t),total:{value:"1",boxes:"1",payType:"1",taxRate:"1",discount:"1"},tableTitles:[{label:"货品型号"},{label:"箱数"},{label:"件数"},{label:"售价"},{label:"金额"}],tableList:[{date:"",data:[],total:0,payStatus:0}]}},created:function(){this.getDict=o["a"].getDict},methods:{getPDF:function(){var t=Object(d["cloneDeep"])(this.form);t.product=Object(d["cloneDeep"])(this.tableList),this.$emit("getPDF",t)},resetData:function(){this.languageChange("CN"),this.form={name:"",seller:"",date:""},this.tableList=[{date:"",data:[],total:0,payStatus:0}]},editData:function(t){for(var e=t.customerName,a=t.status,s=t.details,i=t.createTime,o=t.price,l=t.payType,n=t.taxRate,c=t.discount,r=t.process,u=0,m=0,d=0;d<s.length;d++){var p=s[d];u+=Number(p.caseNum),m+=p.goodsTotal*p.caseNum}this.form={seller:"",date:this.$moment(i).format("YYYY-MM-DD"),orderStatus:a,name:e,pieces:m,process:r},this.tableList=[{date:this.$moment(i).format("YYYY-MM-DD"),data:s}];new v.a(1).add(n);this.total={value:o,boxes:u,payType:l,taxRate:n,discount:c,discountValue:o,taxValue:o}},languageChange:function(t){var e,a;(this.language=t,"CN"==t)&&(this.tableTitles=[{label:"货品型号"},{label:"箱数"},{label:"件数"},{label:"售价"},{label:"金额"}],this.labels=(e={customerName:"客户名称",date:"账单日期",supplier:"销售方",totalSum:"总金额",payStatus:"支付状态",totalBoxes:"总销售箱数",allTotalSum:"总金额"},m(e,"totalBoxes","总箱数"),m(e,"payType","支付方式"),m(e,"taxRate","税收"),m(e,"discount","折扣"),m(e,"pieces","总件数"),m(e,"discountValue","折扣金额"),m(e,"taxValue","税后金额"),e));"EN"==t&&(this.tableTitles=[{label:"Code ID"},{label:"Box"},{label:"Piece"},{label:"Price"},{label:"Sum"}],this.labels=(a={customerName:"Costumer",date:"Date",supplier:"Supplier",payStatus:"Payment Status",totalPics:"Total Piece",totalBoxes:"Total Box",allTotalSum:"Total Sum",taxFee:"TaxRate Fee",pieces:"Pieces",salesInTotal:"Sales In Total",paymentMethod:"Payment Method",price:"Price",codeID:"Code ID",discount:"Discount",sum:"Sum",totalBox:"Total Box",totalSum:"Total Sum",payType:"Payment Method",taxRate:"TaxRate Revenue"},m(a,"discount","Discount"),m(a,"discountValue","Amount after Discount"),m(a,"taxValue","Amount after Tax"),a))},dateFormat:function(t,e){return"CN"==e?this.$moment(t).format("YYYY.MM.DD"):"EN"==e?this.$moment(t).format("YYYY/MM/DD"):void 0}}},h=g,b=(a("aa70"),a("2877")),C=Object(b["a"])(h,n,c,!1,null,"113d1f86",null),y=C.exports,_=a("7dba"),T=a("365c"),x={name:"Order",components:{DialogNewOrder:l["a"],DialogReview:y},data:function(){return{getDict:null,baseDialogVisible:!1,reviewDialogVisible:!1,status:0,selectedSwitch:0,customerName:"",process:"",dict:{},time:[this.$moment().format("YYYY-MM-DD"),this.$moment().format("YYYY-MM-DD")],page:{no:1,total:0,size:20},tableData:[],form:{name:"",season:"",transporter:"",containerType:"",fund:"",arriveTime:"",sellTime:""},rules:{name:[{required:!0,message:"请输入",trigger:"change"}],season:[{required:!0,message:"请选择",trigger:"change"}],transporter:[{required:!0,message:"请选择",trigger:"change"}]},pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}}}},created:function(){this.getData(),this.getDict=o["a"].getDict,this.dict=o["a"]},methods:{switchSelect:function(t){this.selectedSwitch=t},showDialog:function(t,e){var a=this;"new"==t&&(this.baseDialogVisible=!0,this.$nextTick((function(){a.$refs.newOrderDialog.resetData()}))),"edit"==t&&this.$router.push({name:"orderinfoedit",params:{id:e}}),"review"==t&&Object(T["Bb"])({id:e}).then((function(t){a.reviewDialogVisible=!0,a.$nextTick((function(){var e=t;a.$refs.dialogReview.editData(e)}))}))},cancelOrder:function(t){var e=this;this.$confirm("确认删除当前订单？").then((function(a){Object(T["H"])({id:t}).then((function(t){e.$message.success({message:"删除成功"}),e.getData()}))})).catch((function(t){}))},getData:function(){var t=this,e={pageSize:this.page.size,page:this.page.no,customerName:this.customerName,startTime:this.time?this.time[0]:"",endTime:this.time?this.time[1]:"",process:this.process};Object(T["jb"])(e).then((function(e){t.tableData=e.records,t.page.total=e.total,t.page.no=e.current}))},save:function(){this.$refs.newOrderDialog.saveSubmit()},saveSubmit:function(t){var e=this;t.process=0,Object(T["t"])(t).then((function(t){e.$message.success("操作成功"),e.baseDialogVisible=!1,e.getData()}))},askReviewPDF:function(){this.$refs.dialogReview.getPDF()},getReviewPDF:function(){Object(_["a"])("#dialogReview","订单预览")},basePageChange:function(t){this.$set(this.page,"no",t),this.getData()},handleSizeChange:function(t){this.$set(this.page,"size",t),this.$set(this.page,"no",1),this.getData()},timeFormat:function(t){return t?this.$moment(t).format("YYYY.MM.DD"):""}}},D=x,w=(a("dc60"),Object(b["a"])(D,s,i,!1,null,"3e98fa63",null));e["default"]=w.exports},"454f":function(t,e,a){a("46a7");var s=a("584a").Object;t.exports=function(t,e,a){return s.defineProperty(t,e,a)}},"46a7":function(t,e,a){var s=a("63b6");s(s.S+s.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"5e0d":function(t,e,a){},"72e4":function(t,e,a){"use strict";var s=a("c027"),i=a.n(s);i.a},"85f2":function(t,e,a){t.exports=a("454f")},"911c":function(t,e,a){},aa70:function(t,e,a){"use strict";var s=a("d974"),i=a.n(s);i.a},af47:function(t,e,a){"use strict";var s=a("911c"),i=a.n(s);i.a},c027:function(t,e,a){},d974:function(t,e,a){},dc60:function(t,e,a){"use strict";var s=a("5e0d"),i=a.n(s);i.a},de9e:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px",inline:!0}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[t._v("* ")]),t._v("客户")]),a("customer-name-selector",{ref:"nameSelector",staticStyle:{"margin-right":"90px"},attrs:{width:"200px",disabled:t.lockCustomer},on:{selectData:t.handleSelect}})],1),a("el-form-item",{attrs:{label:"地址",prop:"customerAddress"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:t.form.customerAddress,callback:function(e){t.$set(t.form,"customerAddress",e)},expression:"form.customerAddress"}})],1),a("el-form-item",{attrs:{label:"托运部",prop:"transportName"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":t.queryTransport,placeholder:"请输入"},model:{value:t.form.transportName,callback:function(e){t.$set(t.form,"transportName",e)},expression:"form.transportName"}})],1),a("el-form-item",{attrs:{label:"公司",prop:"companyName"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":t.queryCompany,placeholder:"请输入"},on:{select:t.handleSelectCompany},model:{value:t.form.companyName,callback:function(e){t.$set(t.form,"companyName",e)},expression:"form.companyName"}})],1),a("el-form-item",{attrs:{label:"支付方式",prop:"payType"}},[a("el-select",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请选择"},model:{value:t.form.payType,callback:function(e){t.$set(t.form,"payType",e)},expression:"form.payType"}},t._l(t.accountType,(function(t,e){return a("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1)],1),a("el-form-item",{attrs:{label:"货币",prop:"monetaryUnit"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:t.form.monetaryUnit,callback:function(e){t.$set(t.form,"monetaryUnit",e)},expression:"form.monetaryUnit"}})],1),a("el-form-item",{attrs:{label:"折扣",prop:"discount"}},[a("el-input",{staticClass:"form-input",attrs:{max:1,size:"mini",placeholder:"请输入折扣金额"},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),a("el-form-item",{attrs:{label:"税率",prop:"taxRate"}},[a("el-input",{staticClass:"form-input",attrs:{max:1,size:"mini",placeholder:"例如输入14即为14%"},model:{value:t.form.taxRate,callback:function(e){t.$set(t.form,"taxRate",e)},expression:"form.taxRate"}})],1),a("el-form-item",{attrs:{label:"支付状态",prop:"status"}},[a("el-select",{staticClass:"form-input",attrs:{disabled:"",size:"mini",placeholder:"请选择"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.payStatus,(function(t,e){return a("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1)],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"订单时间"}},[a("el-date-picker",{staticClass:"form-input",attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择订单创建日期时间"},model:{value:t.form.createTime,callback:function(e){t.$set(t.form,"createTime",e)},expression:"form.createTime"}})],1)],1),a("div",{staticClass:"prod-table"},[a("div",{staticClass:"label"},[t._v("产品")]),a("div",{staticClass:"table-area"},[a("div",{staticClass:"table-head"},t._l(t.tableTitles,(function(e,s){return a("div",{key:s,staticClass:"head-item",class:"型号"==e.label?"code":""},[t._v(t._s(e.label))])})),0),t._l(t.goodsList,(function(e,s){return a("div",{key:s,staticClass:"table-list"},[a("div",{staticClass:"list-item code"},[a("el-autocomplete",{attrs:{size:"mini","fetch-suggestions":t.queryProduct,placeholder:"请输入产品名"},on:{select:function(e){t.handleProductSelect(e,s)}},model:{value:e.specification,callback:function(a){t.$set(e,"specification",a)},expression:"list.specification"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{attrs:{size:"mini"},on:{change:function(a){return t.changaItem(a,e,s,"caseNum")}},model:{value:e.caseNum,callback:function(a){t.$set(e,"caseNum",a)},expression:"list.caseNum"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{attrs:{size:"mini",disabled:""},on:{change:function(a){return t.changaItem(a,e,s,"goodsTotal")}},model:{value:e.goodsTotal,callback:function(a){t.$set(e,"goodsTotal",a)},expression:"list.goodsTotal"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{attrs:{size:"mini"},on:{change:function(a){return t.changaItem(a,e,s,"goodsPrice")}},model:{value:e.goodsPrice,callback:function(a){t.$set(e,"goodsPrice",a)},expression:"list.goodsPrice"}})],1),a("div",{staticClass:"list-item"},[a("span",{staticClass:"my-checkbox",on:{click:function(a){return t.changaItem(!0,e,s,"isTail")}}},[e.isTail?a("i",{staticClass:"el-icon-check",on:{click:function(a){return a.stopPropagation(),function(a){return t.changaItem(!1,e,s,"isTail")}()}}}):t._e(),e.isTail?t._e():a("i",{staticClass:"el-icon-check",staticStyle:{opacity:"0"}})])]),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.stock)+"\n                ")]),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(t.getListTotalPrice(e)||0)+"\n                ")]),a("div",{staticClass:"del-btn",on:{click:function(e){return t.delList(s)}}},[a("el-button",{attrs:{type:"text",icon:"el-icon-close"}})],1)])})),a("div",{staticClass:"add-btn",on:{click:t.addList}},[a("span",{staticClass:"plus"},[t._v("+")]),a("el-button",{attrs:{type:"text"}},[t._v("添加产品")])],1)],2),a("div",{staticClass:"count"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.getTotal("defect"),expression:"getTotal('defect')"}],staticClass:"count-label defect"},[t._v("报损金额：")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.getTotal("defect"),expression:"getTotal('defect')"}],staticClass:"value defect"},[t._v(t._s(t.getTotal("defect")))]),a("span",{staticClass:"count-label"},[t._v("总销售金额：")]),a("span",{staticClass:"value"},[t._v(t._s(t.getTotal("total")))]),a("span",{staticClass:"count-label"},[t._v("总箱数：")]),a("span",{staticClass:"value"},[t._v(t._s(t.getTotal("caseNum")))]),a("span",{staticClass:"count-label"},[t._v("税后金额：")]),a("span",{staticClass:"value"},[t._v(t._s(t.getTotal("tax")))])])])],1)},i=[],o=(a("c5f6"),a("7f7f"),a("ac6a"),a("2ef0")),l=a("7609"),n=a("365c"),c=a("6a47"),r=a("9dcd"),u=a.n(r),m={name:"DialogNewOrder",components:{CustomerNameSelector:c["a"]},data:function(){return{dict:{},form:{},payStatus:[],accountType:[],taxRate:0,tableTitles:[{label:"型号",name:"type"},{label:"箱数",name:"boxes"},{label:"件数/箱",name:"pics"},{label:"售价",name:"price"},{label:"是否尾箱",name:"isTail"},{label:"库存",name:"isTail"},{label:"总计",name:"total"}],lockCustomer:!1,goodsList:[],listOrigin:{defectTotal:"",specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1},rules:{name:[{required:!0,message:"请输入",trigger:"change"}],status:[{required:!0,message:"请选择",trigger:"change"}],companyName:[{required:!0,message:"请选择",trigger:"change"}]}}},created:function(){this.dict=l["a"],this.payStatus=[l["a"].payStatus[0],l["a"].payStatus[1]],this.accountType=[l["a"].accountType[0],l["a"].accountType[2],l["a"].accountType[3]],this.getTaxRate()},methods:{changaItem:function(t,e,a,s){if("isTail"==s&&!0===t&&e["goodsId"])return this.goodsList[a+1]&&this.goodsList[a+1].goodsId===e.goodsId||(0!==e.tailBox?this.goodsList.splice(a+1,0,{specification:e.specification,goodsId:e.goodsId,goodsName:e.goodsName,caseNum:e.tailBox,stock:e.tailBox+"（尾箱数)",goodsTotal:e.tailTotal,goodsPrice:e.goodsPrice,isTail:!0,defectTotal:""}):this.$message.warning("当前商品尾箱数为0无法选择销售尾箱")),void this.$set(this.goodsList[a],s,!1);"isTail"==s&&!1===t&&e["goodsId"]?this.delList(a):this.$set(this.goodsList[a],s,t)},addList:function(){var t=Object(o["cloneDeep"])(this.listOrigin);this.goodsList.push(t)},delList:function(t){this.goodsList.splice(t,1)},saveSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){t.form.exchangeRate=t.taxRate;var a=Object(o["cloneDeep"])(t.form);a.goodsList=Object(o["cloneDeep"])(t.goodsList);var s=!0;if(a.goodsList.forEach((function(e){e.caseNum>e.stock&&(t.$message.warning("销售箱数不能大于库存！请重新填写"),s=!1),e.isTail?e.isTail=1:e.isTail=0,delete e.stock,delete e.tailBox})),!s)return;a.taxRate=a.taxRate/100,t.$emit("saveData",a)}}))},resetData:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&t.customerId?this.lockCustomer=!0:this.lockCustomer=!1,this.form={customerId:t?t.customerId:"",customerName:t?t.customerName:"",customerAddress:"",transportName:"",payType:"",monetaryUnit:"欧元",discount:0,exchangeRate:"",taxRate:0,companyName:"",companyId:"",status:0,remark:"",createTime:this.$moment().format("YYYY-MM-DD HH:mm:ss")},this.goodsList=[{defectTotal:"",specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1}],this.$nextTick((function(){a&&e.$refs.nameSelector.reset(),e.$refs.form.clearValidate()}))},setName:function(t){this.$refs.nameSelector.setName(t)},editData:function(t){var e=this;this.form=t.form,this.goodsList=t.goodsList,this.$nextTick((function(){e.$refs.form.clearValidate()}))},queryName:function(t,e){Object(n["Mb"])({level:"",status:"",page:1,pageSize:10,userName:t}).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var i=t.records[s];a.push({value:i.memberName,id:i.id,memberName:i.memberName})}e(a)}))},queryProduct:function(t,e){Object(n["o"])({page:1,pageSize:5,specification:t}).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var i=t.records[s];i.value=i.specification,a.push(i)}e(a)}))},queryTransport:function(t,e){var a={pageSize:5,page:1,transporterName:t};Object(n["tb"])(a).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var i=t.records[s];i.value=i.transporterName,a.push(i)}e(a)}))},queryCompany:function(t,e){var a={pageSize:5,page:1,name:t};Object(n["X"])(a).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var i=t.records[s];i.value=i.name,a.push(i)}e(a)}))},handleProductSelect:function(t,e){this.$set(this.goodsList[e],"goodsId",t.goodsId),this.$set(this.goodsList[e],"goodsName",t.name),this.$set(this.goodsList[e],"stock",t.caseNum),this.$set(this.goodsList[e],"tailBox",t.tailBox),this.$set(this.goodsList[e],"tailTotal",t.tailTotal),this.$set(this.goodsList[e],"caseNum",1),this.$set(this.goodsList[e],"goodsTotal",t.goodsTotal),this.$set(this.goodsList[e],"goodsPrice",t.salePrice)},handleSelect:function(t){this.form.customerName=t.memberName,this.form.customerId=t.id},handleSelectCompany:function(t){this.form.companyId=t.id},getTaxRate:function(){var t=this,e={status:"taxRate"};Object(n["sb"])(e).then((function(e){var a=e instanceof Array?e:[];t.taxRate=a[0].configValue}))},getTotal:function(t){for(var e=0,a=0,s=this.form.discount||0,i=this.form.taxRate||0,o=0,l=0;l<this.goodsList.length;l++){var n=this.goodsList[l],c=this.getListTotalPrice(n),r=n.defectTotal||0,m=n.goodsPrice||0;e+=Number(n.caseNum),a+=c,o+=new u.a(r).times(m).toNumber()}if("caseNum"==t)return e;if("total"==t)return a-o;if("discount"==t){var d=new u.a(a).minus(s).minus(o).toNumber();return d}if("tax"==t){var p=new u.a(a),f=new u.a(1).add(i/100);return p.times(f).minus(s).minus(o).toNumber()}return"defect"==t?-o:void 0},getListTotalPrice:function(t){var e=t.caseNum,a=void 0===e?0:e,s=t.goodsTotal,i=void 0===s?0:s,o=t.goodsPrice,l=void 0===o?0:o;a=a||0,i=i||0,l=l||0;var n=new u.a(a),c=n.times(i).times(l);return c.toNumber()}}},d=m,p=(a("af47"),a("2877")),f=Object(p["a"])(d,s,i,!1,null,"7e2a8aca",null);e["a"]=f.exports},f74d:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-selector"},[a("div",{staticClass:"date"},[a("el-select",{ref:"selector",attrs:{placeholder:t.placeholder},on:{change:t.change},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("div",{staticClass:"showDate",style:"width:"+t.width,on:{click:t.dateClick}},[t._v("\n        "+t._s(t.showValue?t.showValue:t.placeholder)+"\n        "),a("span",{staticClass:"unfold-pic"})])])},i=[],o={name:"DateSelector",props:{placeholder:String,options:Array,width:{type:String,default:"83px"}},data:function(){return{value:"",showValue:""}},mounted:function(){},methods:{dateClick:function(){console.log(this.$refs),this.$refs.selector.focus()},change:function(t){console.log(t);for(var e=0;e<this.options.length;e++){var a=this.options[e];if(a.value==t){this.showValue=a.label;break}}this.$emit("change",t)}}},l=o,n=(a("72e4"),a("2877")),c=Object(n["a"])(l,s,i,!1,null,"f8f72a3c",null);e["a"]=c.exports}}]);