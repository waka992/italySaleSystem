(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dailyjournal"],{"07ee":function(e,a,t){"use strict";var l=t("5b6c"),i=t.n(l);i.a},2957:function(e,a,t){"use strict";var l=function(){var e=this,a=e.$createElement;e._self._c;return e._m(0)},i=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"pie-chart-box"},[t("div",{staticClass:"line-chart",attrs:{id:"line-chart"}})])}],n=(t("2ef0"),t("63e3")),o={name:"PieChart",props:{height:{type:String,default:"0px"},width:{type:String,default:"0px"}},data:function(){return{chart:null}},mounted:function(){this.initCharts()},methods:{initCharts:function(){var e=null;if(!this.chart){var a=this.$el.querySelector(".line-chart");e=n["a"](a,this.theme,{width:this.width||"auto",height:this.height,renderer:"canvas"});var t={legend:{type:"plain",orient:"vertical",left:100,right:0,top:0,bottom:0,itemWidth:11,itemHeight:6,data:[]},grid:{left:"left",right:0},series:[{name:"姓名",type:"pie",hoverAnimation:!1,animation:!1,center:["45px","50%"],labelLine:{show:!1},label:{show:!1},radius:"45px",data:[]}]};e.setOption(t),this.chart=e}},setData:function(e){this.chart.setOption(e)}}},s=o,c=(t("c94c"),t("2877")),r=Object(c["a"])(s,l,i,!1,null,"3822263b",null);a["a"]=r.exports},"30ba":function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"daily-journal-box"},[t("div",{staticClass:"crumbs"},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",[e._v("公司")]),t("el-breadcrumb-item",[e._v("流水日记账")])],1)],1),t("div",{staticClass:"new-btn"},[t("el-button",{attrs:{type:"primary"},on:{click:e.addReady}},[e._v("+新增流水")])],1),t("div",{staticClass:"flex-box"},[t("div",{staticClass:"left-box"},[t("div",{staticClass:"box"},[t("div",{staticClass:"title"},[e._v("今日收入流水")]),t("div",{staticClass:"operate"},[t("el-input",{staticClass:"name-search",attrs:{"suffix-icon":"el-icon-search",placeholder:"输入公司名称"},model:{value:e.income.companyName,callback:function(a){e.$set(e.income,"companyName",a)},expression:"income.companyName"}}),t("div",{staticClass:"timer"},[t("span",{staticClass:"label"},[e._v("筛选日期")]),t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.income.date,callback:function(a){e.$set(e.income,"date",a)},expression:"income.date"}})],1),t("div",{staticClass:"selector"},[t("span",{staticClass:"label"},[e._v("付款方式")]),t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.income.payment,callback:function(a){e.$set(e.income,"payment",a)},expression:"income.payment"}},e._l(e.dict.accountType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-button",{staticStyle:{"margin-left":"16px"},attrs:{icon:"el-icon-search"},on:{click:e.getIncomeData}})],1),t("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.income.tableData,stripe:"",height:"314","header-cell-class-name":"table-header"}},[t("el-table-column",{attrs:{prop:"date",label:"日期",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n                            "+e._s(e.timeFormat(a.row.createTime))+"\n                        ")]}}])}),t("el-table-column",{attrs:{prop:"customerName",label:"客户",align:"center"}}),t("el-table-column",{attrs:{label:"支付方式",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(e.dict.getDict(a.row.accountType,"accountType")))]}}])}),t("el-table-column",{attrs:{prop:"money",label:"金额",align:"center",width:"80"}}),t("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.income.page.no,"page-size":e.income.page.size,"page-sizes":[5,10,20],total:e.income.page.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleIncomeSizeChange,"current-change":e.baseIncomePageChange}})],1)],1),t("div",{staticClass:"box"},[t("div",{staticClass:"title"},[e._v("今日支出流水")]),t("div",{staticClass:"operate"},[t("div",{staticClass:"timer"},[t("span",{staticClass:"label"},[e._v("筛选日期")]),t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.pay.date,callback:function(a){e.$set(e.pay,"date",a)},expression:"pay.date"}})],1),t("div",{staticClass:"selector"},[t("span",{staticClass:"label"},[e._v("付款方式")]),t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.pay.payment,callback:function(a){e.$set(e.pay,"payment",a)},expression:"pay.payment"}},e._l(e.dict.accountType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-button",{staticStyle:{"margin-left":"16px"},attrs:{icon:"el-icon-search"},on:{click:e.getPayData}})],1)]),t("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.pay.tableData,stripe:"",height:"314","header-cell-class-name":"table-header"}},[t("el-table-column",{attrs:{label:"日期",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n                            "+e._s(e.timeFormat(a.row.createTime))+"\n                        ")]}}])}),t("el-table-column",{attrs:{prop:"customerName",label:"去向",align:"center"}}),t("el-table-column",{attrs:{label:"支付方式",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(e._s(e.dict.getDict(a.row.accountType,"accountType")))]}}])}),t("el-table-column",{attrs:{prop:"money",label:"金额",align:"center",width:"80"}}),t("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center",width:"100"}})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.pay.page.no,"page-size":e.pay.page.size,"page-sizes":[5,10,20],total:e.pay.page.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handlePaySizeChange,"current-change":e.basePayPageChange}})],1)],1)]),t("div",{staticClass:"right-box"},[t("div",{staticClass:"title"},[e._v("流水总汇")]),t("div",{staticClass:"date-select"},[t("date-selector",{on:{change:e.getFlowDate}})],1),t("div",{staticClass:"top-chart"},[t("div",{staticClass:"top-total"},[e._v("总收入："+e._s(e.income.total)+"元")]),t("pie-chart",{ref:"pieChart1",attrs:{width:"200",height:"164"}})],1),t("div",{staticClass:"bottom-chart"},[t("div",{staticClass:"bottom-total"},[e._v("总支出："+e._s(e.pay.total)+"元")]),t("pie-chart",{ref:"pieChart2",attrs:{width:"200",height:"164"}})],1),t("div",{staticClass:"statics"},[t("div",{staticClass:"left-statics"},[t("div",{staticClass:"title"},[e._v("总现金余数")]),t("div",{staticClass:"amount"},[e._v(e._s(e.income.total))])]),t("div",{staticClass:"right-statics"},[t("div",{staticClass:"title"},[e._v("总汇款余数")]),t("div",{staticClass:"amount"},[e._v(e._s(e.pay.total))])])])])]),t("el-dialog",{attrs:{"close-on-click-modal":!1,"show-close":!1,title:"新增支出/收入记录",visible:e.baseDialogVisible,width:"551px"},on:{"update:visible":function(a){e.baseDialogVisible=a}}},[t("el-form",{ref:"incomeform",attrs:{model:e.incomeform,"label-width":"178px",rules:e.incomerules}},[t("el-form-item",{attrs:{label:"公司名称",prop:"companyName"}},[t("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":e.queryCompany,placeholder:"请输入"},on:{select:e.handleSelectCompany},model:{value:e.incomeform.companyName,callback:function(a){e.$set(e.incomeform,"companyName",a)},expression:"incomeform.companyName"}})],1),t("el-form-item",{attrs:{label:"客户名称",prop:"customerName"}},[t("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":e.queryName,maxlength:15,"show-word-limit":"",placeholder:"请输入客户名"},on:{select:e.handleSelect},model:{value:e.incomeform.customerName,callback:function(a){e.$set(e.incomeform,"customerName",a)},expression:"incomeform.customerName"}})],1),t("el-form-item",{attrs:{label:"日期",prop:"createTime"}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择今日日期时间"},model:{value:e.incomeform.createTime,callback:function(a){e.$set(e.incomeform,"createTime",a)},expression:"incomeform.createTime"}})],1),t("el-form-item",{attrs:{label:"收入/支出",prop:"money"}},[t("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"例如+1000"},model:{value:e.incomeform.money,callback:function(a){e.$set(e.incomeform,"money",a)},expression:"incomeform.money"}})],1),t("el-form-item",{attrs:{label:"资金状态",prop:"accountType"}},[t("el-select",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请选择"},model:{value:e.incomeform.accountType,callback:function(a){e.$set(e.incomeform,"accountType",a)},expression:"incomeform.accountType"}},e._l(e.dict.accountType,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入备注内容"},model:{value:e.incomeform.remark,callback:function(a){e.$set(e.incomeform,"remark",a)},expression:"incomeform.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(a){e.baseDialogVisible=!1}}},[e._v("取消")]),t("el-button",{staticClass:"curr-btn",attrs:{type:"primary"},on:{click:e.saveIncome}},[e._v("保存")])],1)],1)],1)},i=[],n=(t("7f7f"),t("2ef0")),o=t("2957"),s=t("d0c2"),c=t("365c"),r=t("c1df"),m=t.n(r),u=t("7609"),p={name:"DailyJournal",components:{DateSelector:s["a"],PieChart:o["a"]},data:function(){return{dict:{},baseDialogVisible:!1,incomeform:{},income:{companyName:"",date:"",payment:"",total:0,tableData:[],page:{no:1,total:0,size:5}},pay:{date:"",payment:"",total:0,tableData:[],page:{no:1,total:0,size:5}},rules:{name:[{required:!0,message:"请输入公司名",trigger:"change"}],person:[{required:!0,message:"请输入法人代表",trigger:"change"}],license:[{required:!0,message:"请输入营业执照注册号",trigger:"change"}],code:[{required:!0,message:"请输入税务代码",trigger:"change"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"change"}]},incomerules:{companyName:[{required:!0,message:"请输入",trigger:"change"}],customerName:[{required:!0,message:"请输入客户名",trigger:"change"}],createTime:[{required:!0,message:"请输入日期",trigger:"change"}],money:[{required:!0,message:"请输入",trigger:"change"}]}}},created:function(){this.getIncomeData(),this.getPayData(),this.dict=u["a"]},mounted:function(){this.getPieData()},methods:{getPieData:function(e){var a=this,t="";e&&(t=m()(e).format("YYYY-MM-DD"));var l={bookDate:t,payDate:t};Object(c["s"])(l).then((function(e){for(var t=e.cash,l=e.remittance,i=e.incomde,o=e.pay,s=Object(n["cloneDeep"])(a.dict.accountType),c=[],r=[],m=0;m<s.length;m++){var u=s[m];c.push({name:u.label,value:0}),r.push({name:u.label,value:0})}for(var p=0;p<i.length;p++){var d=i[p];console.log(d.book_type),console.log(c),c[d.book_type].value=d.cash}for(var h=0;h<o.length;h++){var f=o[h];r[f.book_type].value=f.cash}a.income.total=t||0,a.pay.total=l||0,a.setChartData(c,r)}))},resetData:function(){this.incomeform={companyId:"",customerName:"",customerId:"",createTime:"",money:"",remark:"",accountType:""}},addReady:function(){var e=this;this.resetData(),this.baseDialogVisible=!0,this.$nextTick((function(){e.$refs.incomeform.clearValidate()}))},getIncomeData:function(){var e=this,a={pageSize:this.income.page.size,page:this.income.page.no,bookType:1,companyName:this.income.companyName,incomeDate:this.income.date,payType:this.income.payment};Object(c["J"])(a).then((function(a){e.income.tableData=a.records,e.income.page.total=a.total,e.income.page.no=a.current}))},getPayData:function(){var e=this,a={pageSize:this.pay.page.size,page:this.pay.page.no,bookType:0,companyName:"",incomeDate:this.pay.date,payType:this.pay.payment};Object(c["J"])(a).then((function(a){e.pay.tableData=a.records,e.pay.page.total=a.total,e.pay.page.no=a.current}))},save:function(){Object(n["cloneDeep"])(this.form);this.$refs.form.validate((function(e){}))},checkDetail:function(e){this.$router.push({name:"compbaseinfodetail",params:{id:e}})},setChartData:function(e,a){console.log(e,a);for(var t={color:["#3BA0F6","#5BE7C7","#F6913B"],legend:{top:40,data:[]},series:[{data:[]}]},l={color:["#EA7DE8","#E7CF5B"],legend:{top:40,data:[]},series:[{data:[]}]},i=0;i<e.length;i++){var n=e[i],o="".concat(n.name," ").concat(n.value);t.legend.data.push(o),e[i].name=o}t.series[0].data=e;for(var s=0;s<a.length;s++){var c=a[s],r="".concat(c.name," ").concat(c.value);l.legend.data.push(r),a[s].name=r}l.series[0].data=a,console.log(t),this.$refs.pieChart1.setData(t),this.$refs.pieChart2.setData(l)},saveIncome:function(){var e=this,a=Object(n["cloneDeep"])(this.incomeform);a.money<0?a.bookType=0:a.bookType=1,a.money=Math.abs(a.money),console.log(this.incomeform),this.$refs.incomeform.validate((function(t){t&&Object(c["a"])(a).then((function(a){a&&(e.$message.success({message:"新增成功"}),e.baseDialogVisible=!1,e.getIncomeData(),e.getPayData())}))}))},queryName:function(e,a){Object(c["Y"])({level:"",status:"",page:1,pageSize:5,userName:e}).then((function(e){for(var t=[],l=0;l<e.records.length;l++){var i=e.records[l];t.push({value:i.memberName,id:i.id,memberName:i.memberName})}a(t)}))},handleSelect:function(e){this.incomeform.customerId=e.id},queryCompany:function(e,a){var t={pageSize:5,page:1,name:e};Object(c["D"])(t).then((function(e){for(var t=[],l=0;l<e.records.length;l++){var i=e.records[l];i.value=i.name,t.push(i)}a(t)}))},handleSelectCompany:function(e){console.log(e),this.incomeform.companyName=e.name,this.incomeform.companyId=e.id},getFlowDate:function(e){console.log(e),this.getPieData(e)},baseIncomePageChange:function(e){this.$set(this.income.page,"no",e),this.getIncomeData()},handleIncomeSizeChange:function(e){console.log("每页 ".concat(e," 条"))},basePayPageChange:function(e){this.$set(this.pay.page,"no",e),this.getPayData()},handlePaySizeChange:function(e){console.log("每页 ".concat(e," 条"))},timeFormat:function(e){return m()(e).format("YYYY-MM-DD")}}},d=p,h=(t("07ee"),t("2877")),f=Object(h["a"])(d,l,i,!1,null,"d089dc12",null);a["default"]=f.exports},"4e21":function(e,a,t){},"5b6c":function(e,a,t){},7609:function(e,a,t){"use strict";var l={accountType:[{value:0,label:"现金"},{value:1,label:"转账"},{value:2,label:"微信"},{value:3,label:"发票"}],payWay:[{value:0,label:"发票"},{value:1,label:"汇款"}],payENWay:[{value:0,label:"INVOICE"},{value:1,label:"CASH"}],payStatus:[{value:0,label:"未支付"},{value:1,label:"已支付"},{value:2,label:"欠款"},{value:3,label:"已结欠"}],payENStatus:[{value:0,label:"PAID"},{value:1,label:"UNPAID"}],soldStatus:[{value:"",label:"预录入"},{value:0,label:"即将到货"},{value:1,label:"现货"},{value:2,label:"售罄"}],settingItemValue:[{value:5,label:"特色/Special"},{value:0,label:"颜色/Color"},{value:1,label:"尺码/Size"},{value:2,label:"面料/Material"},{value:4,label:"配比/Ratio"}],containerStatus:[{value:0,label:"未运输"},{value:1,label:"已发货"},{value:2,label:"已到达待确认"},{value:3,label:"已确认货物"}],transportType:[{value:0,label:"海运"},{value:1,label:"陆运"},{value:2,label:"空运"},{value:3,label:"其他"}],getDict:function(e,a){for(var t=0;t<l[a].length;t++){var i=l[a][t];if(i.value==e)return i.label}}};a["a"]=l},"948e":function(e,a,t){"use strict";var l=t("4e21"),i=t.n(l);i.a},b424:function(e,a,t){},c94c:function(e,a,t){"use strict";var l=t("b424"),i=t.n(l);i.a},d0c2:function(e,a,t){"use strict";var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"my-selector"},[t("div",{staticClass:"date"},[t("el-date-picker",{ref:"dateSelector",attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:e.dateChange},model:{value:e.date,callback:function(a){e.date=a},expression:"date"}})],1),t("div",{staticClass:"showDate",on:{click:e.dateClick}},[e._v("\n        "+e._s(e.date?e.date:"请选日期")+"\n        "),t("span",{staticClass:"unfold-pic"})])])},i=[],n={name:"DateSelector",props:{},data:function(){return{date:""}},mounted:function(){},methods:{resetDate:function(){this.date=""},dateClick:function(){this.$refs.dateSelector.focus()},dateChange:function(e){this.date=e,this.$emit("change",e)}}},o=n,s=(t("948e"),t("2877")),c=Object(s["a"])(o,l,i,!1,null,"4c16e271",null);a["a"]=c.exports}}]);