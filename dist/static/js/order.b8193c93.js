(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{"0530":function(e,t,a){},"118a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order-box"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("销售")]),a("el-breadcrumb-item",[e._v("销售订单")])],1)],1),a("div",{staticClass:"switch"},[a("div",{staticClass:"switch-item",class:0==e.selectedSwitch?"selected":"",on:{click:function(t){return e.switchSelect(0)}}},[e._v("全部订单")])]),a("div",{staticClass:"box"},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"name-search",attrs:{size:"mini","suffix-icon":"el-icon-search",placeholder:"输入客户名"},model:{value:e.customerName,callback:function(t){e.customerName=t},expression:"customerName"}}),a("div",{staticClass:"time"},[a("span",{staticClass:"label"},[e._v("时间")]),a("div",{staticClass:"time-comp"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)]),a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.getData}}),a("el-button",{staticClass:"new-btn",attrs:{type:"primary"},on:{click:function(t){return e.showDialog("new")}}},[e._v("新订单")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,stripe:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"customerName",label:"客户",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.timeFormat(t.row.createTime))+"\n                ")]}}])}),a("el-table-column",{attrs:{prop:"caseNum",label:"箱数",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"金额",align:"center"}}),a("el-table-column",{attrs:{prop:"payStatus",label:"支付方式",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.getDict(t.row.payType,"payWay"))+"\n                ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showDialog("edit",t.row.id)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showDialog("review",t.row.id)}}},[e._v("预览")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.page.no,"page-size":e.page.size,"page-sizes":[5,10,20],total:e.page.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.basePageChange}})],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!1,title:"新订单",visible:e.baseDialogVisible,width:"830px"},on:{"update:visible":function(t){e.baseDialogVisible=t}}},[a("dialog-new-order",{ref:"newOrderDialog",on:{saveData:e.saveSubmit}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(t){e.baseDialogVisible=!1}}},[e._v("取消")]),a("el-button",{staticClass:"curr-btn",attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")])],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!1,title:"订单预览",visible:e.reviewDialogVisible,width:"830px"},on:{"update:visible":function(t){e.reviewDialogVisible=t}}},[a("dialog-review",{ref:"dialogReview",on:{getPDF:e.getReviewPDF}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(t){e.reviewDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.askReviewPDF}},[e._v("生成PDF")])],1)],1)],1)},i=[],l=a("7609"),o=a("de9e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dialog-bill"},[a("div",{staticClass:"language"},[a("common-selector",{attrs:{width:"70px",placeholder:"请选择语言",options:[{label:"中文版本",value:"CN"},{label:"English",value:"EN"}]},on:{change:e.languageChange}})],1),"CN"==e.language?a("div",{staticClass:"bill-form"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v("订单日期")]),a("span",{staticClass:"value"},[e._v(e._s(e.form.date))])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v("销售方")]),a("span",{staticClass:"value"},[e._v(e._s(e.form.seller))])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v("订单状态")]),a("span",{staticClass:"value"},[e._v(e._s(e.form.orderStatus))])])],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v("客户名称")]),a("span",{staticClass:"value"},[e._v(e._s(e.form.name))])])],1)],1):e._e(),"EN"==e.language?a("div",{staticClass:"bill-form"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v(e._s(e.labels.date))]),"CN"==e.language?a("span",{staticClass:"value"},[e._v(e._s(e.dateFormat(e.form.date,"CN")))]):a("span",{staticClass:"value"},[e._v(e._s(e.dateFormat(e.form.date,"EN")))])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v(e._s(e.labels.pieces))]),a("span",{staticClass:"value"},[e._v(e._s(e.form.pieces))])])],1),a("el-row"),a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"title"},[e._v(e._s(e.labels.customerName))]),a("span",{staticClass:"value"},[e._v(e._s(e.form.name))])])],1),a("el-row")],1):e._e(),e._l(e.tableList,(function(t,s){return a("div",{key:s,staticClass:"prod-table"},[a("div",{staticClass:"table-area"},[a("div",{staticClass:"table-head"},e._l(e.tableTitles,(function(t,s){return a("div",{key:s,staticClass:"head-item"},[e._v(e._s(t.label))])})),0),e._l(t.data,(function(t,s){return a("div",{key:s,staticClass:"table-list",class:s%2==0?"odd":"double"},[a("div",{staticClass:"list-item"},[e._v("\n                        "+e._s(t.specification)+"\n                    ")]),a("div",{staticClass:"list-item"},[e._v("\n                        "+e._s(t.caseNum)+"\n                    ")]),a("div",{staticClass:"list-item"},[e._v("\n                        "+e._s(t.goodsTotal)+"\n                    ")]),a("div",{staticClass:"list-item"},[e._v("\n                        "+e._s(t.goodsPrice)+"\n                    ")]),a("div",{staticClass:"list-item"},[e._v("\n                        "+e._s(t.caseNum*t.goodsTotal*t.goodsPrice||0)+"\n                        ")])])}))],2)])})),a("div",{staticClass:"total-statistics"},[a("div",{staticClass:"statistics-title"},[e._v("总汇：")]),a("div",{staticClass:"statistics-box"},[a("div",{staticClass:"statistics-inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[e._v(e._s(e.labels.allTotalSum))]),a("div",{staticClass:"item-value"},[e._v(e._s(e.total.value))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[e._v(e._s(e.labels.totalBoxes))]),a("div",{staticClass:"item-value"},[e._v(e._s(e.total.boxes))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[e._v(e._s(e.labels.payType))]),"CN"==e.language?a("div",{staticClass:"item-value"},[e._v(e._s(e.getDict(e.total.payType,"payWay")))]):a("div",{staticClass:"item-value"},[e._v(e._s(e.getDict(e.total.payType,"payENWay")))])])]),a("div",{staticClass:"statistics-inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[e._v(e._s(e.labels.taxRate))]),a("div",{staticClass:"item-value"},[e._v(e._s(e.total.taxRate))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[e._v(e._s(e.labels.discount))]),a("div",{staticClass:"item-value"},[e._v(e._s(e.total.discount))])]),e._m(0)])])])],2)},c=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"}),a("div",{staticClass:"item-value"})])}],r=(a("c5f6"),a("bd86")),u=a("2ef0"),m=a("f74d"),d=a("c1df"),p=a.n(d),f={name:"DialogBill",components:{CommonSelector:m["a"]},data:function(){var e;return{language:"CN",totalBoxes:2300,totalValue:2800,payStatus:0,form:{},labels:(e={customerName:"客户名称",date:"账单日期",supplier:"销售方",totalSum:"总销售金额",payStatus:"支付状态",totalBoxes:"总销售箱数",allTotalSum:"总销售金额"},Object(r["a"])(e,"totalBoxes","总箱数"),Object(r["a"])(e,"payType","支付方式"),Object(r["a"])(e,"taxRate","税收"),Object(r["a"])(e,"discount","折扣"),e),total:{value:"1",boxes:"1",payType:"1",taxRate:"1",discount:"1"},tableTitles:[{label:"货品型号"},{label:"箱数"},{label:"件数"},{label:"售价"},{label:"金额"}],tableList:[{date:"2020.11.29",data:[{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"}],total:2200,payStatus:0}]}},created:function(){this.getDict=l["a"].getDict},methods:{getPDF:function(){var e=Object(u["cloneDeep"])(this.form);e.product=Object(u["cloneDeep"])(this.tableList),this.$emit("getPDF",e)},resetData:function(){this.languageChange("CN"),this.form={name:"广州市歌莉娅制衣有限公司",seller:"广州市xx有限公司",date:"2020.11.29"},this.tableList=[{date:"2020.11.29",data:[{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"},{type:"H001",boxes:"3",pics:"70",price:"10"}],total:2200,payStatus:0}]},editData:function(e){for(var t=e.customerName,a=e.status,s=e.details,i=e.createTime,l=e.price,o=e.payType,n=e.taxRate,c=e.discount,r=0,u=0,m=0;m<s.length;m++){var d=s[m];r+=Number(d.caseNum),u+=d.goodsTotal*d.caseNum}this.form={seller:"",date:p()(i).format("YYYY-MM-DD"),orderStatus:a,name:t,pieces:u},this.tableList=[{date:p()(i).format("YYYY-MM-DD"),data:s}],this.total={value:l,boxes:r,payType:o,taxRate:n,discount:c}},languageChange:function(e){var t;(this.language=e,"CN"==e)&&(this.tableTitles=[{label:"货品型号"},{label:"箱数"},{label:"件数"},{label:"售价"},{label:"金额"}],this.labels=(t={customerName:"客户名称",date:"账单日期",supplier:"销售方",totalSum:"总销售金额",payStatus:"支付状态",totalBoxes:"总销售箱数",allTotalSum:"总销售金额"},Object(r["a"])(t,"totalBoxes","总箱数"),Object(r["a"])(t,"payType","支付方式"),Object(r["a"])(t,"taxRate","税收"),Object(r["a"])(t,"discount","折扣"),t));"EN"==e&&(this.tableTitles=[{label:"Code ID"},{label:"Box"},{label:"Piece"},{label:"Price"},{label:"Sum"}],this.labels=Object(r["a"])({customerName:"Costumer",date:"Date",supplier:"Supplier",payStatus:"Payment Status",totalPics:"Total Piece",totalBoxes:"Total Box",allTotalSum:"Total Sum",taxFee:"taxRate Fee",pieces:"Pieces",salesInTotal:"Sales In Total",paymentMethod:"Payment Method",price:"Price",codeID:"Code ID",discount:"Discount",sum:"Sum",totalBox:"Total Box",totalSum:"Total Sum",payType:"Payment Method",taxRate:"taxRate Revenue"},"discount","Discount"))},dateFormat:function(e,t){return"CN"==t?p()(e).format("YYYY.MM.DD"):"EN"==t?p()(e).format("YYYY/MM/DD"):void 0}}},v=f,h=(a("f1cd"),a("2877")),b=Object(h["a"])(v,n,c,!1,null,"77911ac7",null),g=b.exports,y=a("365c"),C={name:"Order",components:{DialogNewOrder:o["a"],DialogReview:g},data:function(){return{getDict:null,baseDialogVisible:!1,reviewDialogVisible:!1,status:0,selectedSwitch:0,customerName:"",time:[],page:{no:1,total:0,size:20},tableData:[],form:{name:"",season:"",transporter:"",containerType:"",fund:"",arriveTime:"",sellTime:""},rules:{name:[{required:!0,message:"请输入",trigger:"change"}],season:[{required:!0,message:"请选择",trigger:"change"}],transporter:[{required:!0,message:"请选择",trigger:"change"}]}}},created:function(){this.getData(),this.getDict=l["a"].getDict},methods:{switchSelect:function(e){this.selectedSwitch=e},showDialog:function(e,t){var a=this;"new"==e&&(this.baseDialogVisible=!0,this.$nextTick((function(){a.$refs.newOrderDialog.resetData()}))),"edit"==e&&this.$router.push({name:"orderinfoedit",params:{id:t}}),"review"==e&&Object(y["R"])({id:t}).then((function(e){a.reviewDialogVisible=!0,a.$nextTick((function(){var t=e;a.$refs.dialogReview.editData(t)}))}))},getData:function(){var e=this,t={pageSize:this.page.size,page:this.page.no,customerName:this.customerName,startTime:this.time?this.time[0]:"",endTime:this.time?this.time[1]:""};Object(y["I"])(t).then((function(t){e.tableData=t.records,e.page.total=t.total,e.page.no=t.current}))},save:function(){this.$refs.newOrderDialog.saveSubmit()},saveSubmit:function(e){var t=this;e.process=0,Object(y["n"])(e).then((function(e){t.$message.success("操作成功"),t.baseDialogVisible=!1,t.getData()}))},askReviewPDF:function(){this.$refs.dialogReview.getPDF()},getReviewPDF:function(){},basePageChange:function(e){this.$set(this.page,"no",e),this.getData()},handleSizeChange:function(e){this.$set(this.page,"size",e),this.$set(this.page,"no",1),this.getData()},timeFormat:function(e){return p()(e).format("YYYY.MM.DD")}}},x=C,_=(a("ed8d"),Object(h["a"])(x,s,i,!1,null,"56b2529c",null));t["default"]=_.exports},"1a72":function(e,t,a){},"454f":function(e,t,a){a("46a7");var s=a("584a").Object;e.exports=function(e,t,a){return s.defineProperty(e,t,a)}},"46a7":function(e,t,a){var s=a("63b6");s(s.S+s.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"4c8d":function(e,t,a){},"651a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{name:"order"}}},[e._v("销售订单")]),a("el-breadcrumb-item",[e._v("销售订单详情")])],1),a("div",{staticClass:"edit-btn"},[a("el-popover",{attrs:{placement:"bottom"},model:{value:e.delVisible,callback:function(t){e.delVisible=t},expression:"delVisible"}},[a("p",[e._v("确认通过审核？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.delVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.approval}},[e._v("确定")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.process,expression:"process == 0"}],attrs:{slot:"reference",plain:"",icon:"el-icon-circle-check"},on:{confirm:e.approval},slot:"reference"},[e._v("审核确认")])],1),a("el-button",{attrs:{plain:"",icon:"el-icon-edit"},on:{click:e.edit}},[e._v("编辑")])],1)],1),a("div",{staticClass:"box"},[a("el-form",{ref:"form",staticClass:"new-prodt-form",attrs:{rules:e.rules,inline:!0,model:e.form,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("* ")]),e._v("客户")]),a("customer-name-selector",{ref:"nameSelector",staticStyle:{"margin-right":"90px"},attrs:{width:"150px",disabled:"check"===e.todo},on:{selectData:e.handleSelect}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"地址",prop:"customerAddress"}},[a("el-input",{attrs:{disabled:"check"===e.todo,size:"mini",placeholder:"请输入"},model:{value:e.form.customerAddress,callback:function(t){e.$set(e.form,"customerAddress",t)},expression:"form.customerAddress"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"公司",prop:"company"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini",disabled:"check"===e.todo,"fetch-suggestions":e.queryCompany,placeholder:"请输入"},on:{selectData:e.handleSelectCompany},model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName",t)},expression:"form.companyName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"托运部",prop:"transportName"}},[a("el-autocomplete",{attrs:{disabled:"check"===e.todo,size:"mini","fetch-suggestions":e.queryTransport,placeholder:"请输入"},model:{value:e.form.transportName,callback:function(t){e.$set(e.form,"transportName",t)},expression:"form.transportName"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"支付方式",prop:"payType"}},[a("el-select",{attrs:{disabled:"check"===e.todo,size:"mini",placeholder:"请选择"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},e._l(e.dict.payWay,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"货币",prop:"monetaryUnit"}},[a("el-input",{attrs:{disabled:"check"===e.todo,size:"mini",placeholder:"请输入"},model:{value:e.form.monetaryUnit,callback:function(t){e.$set(e.form,"monetaryUnit",t)},expression:"form.monetaryUnit"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"折扣",prop:"discount"}},[a("el-input",{attrs:{disabled:"check"===e.todo,max:1,size:"mini",placeholder:"请输入0-1，例如八折为0.8"},model:{value:e.form.discount,callback:function(t){e.$set(e.form,"discount",t)},expression:"form.discount"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"税率",prop:"taxRate"}},[a("el-input",{attrs:{disabled:"check"===e.todo,max:1,size:"mini",placeholder:"请输入小数，例如0.11"},model:{value:e.form.taxRate,callback:function(t){e.$set(e.form,"taxRate",t)},expression:"form.taxRate"}})],1)],1),a("el-col",{attrs:{span:8}}),a("el-col",{attrs:{span:8}})],1),a("el-row",[a("div",{staticClass:"pic-upload"},[a("div",{staticClass:"pic-title"},[e._v("产品")]),a("div",{staticClass:"table-area"},[a("div",{staticClass:"table-head"},e._l(e.tableTitles,(function(t,s){return a("div",{key:s,staticClass:"head-item"},[e._v(e._s(t.label))])})),0),e._l(e.goodsList,(function(t,s){return a("div",{key:s,staticClass:"table-list"},[a("div",{staticClass:"list-item"},[a("el-autocomplete",{attrs:{disabled:"check"===e.todo,"fetch-suggestions":e.queryProduct,placeholder:"请输入产品名"},on:{select:function(t){e.handleProductSelect(t,s)}},model:{value:t.specification,callback:function(a){e.$set(t,"specification",a)},expression:"list.specification"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{attrs:{disabled:"check"===e.todo},on:{change:function(a){return e.changaItem(t.caseNum,s,"caseNum")}},model:{value:t.caseNum,callback:function(a){e.$set(t,"caseNum",a)},expression:"list.caseNum"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{attrs:{disabled:"check"===e.todo},on:{change:function(a){return e.changaItem(t.goodsTotal,s,"goodsTotal")}},model:{value:t.goodsTotal,callback:function(a){e.$set(t,"goodsTotal",a)},expression:"list.goodsTotal"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{attrs:{disabled:"check"===e.todo},on:{change:function(a){return e.changaItem(t.goodsPrice,s,"goodsPrice")}},model:{value:t.goodsPrice,callback:function(a){e.$set(t,"goodsPrice",a)},expression:"list.goodsPrice"}})],1),a("div",{staticClass:"list-item"},[a("el-checkbox",{attrs:{disabled:"check"===e.todo},model:{value:t.isTail,callback:function(a){e.$set(t,"isTail",a)},expression:"list.isTail"}})],1),a("div",{staticClass:"list-item"},[e._v("\n                                    "+e._s(t.caseNum*t.goodsTotal*t.goodsPrice||0)+"\n                                ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"check"!==e.todo,expression:"todo !== 'check'"}],staticClass:"del-btn",on:{click:function(t){return e.delList(s)}}},[a("el-button",{attrs:{type:"text",icon:"el-icon-close"}})],1)])})),a("div",{directives:[{name:"show",rawName:"v-show",value:"check"!==e.todo,expression:"todo !== 'check'"}],staticClass:"add-btn",on:{click:e.addList}},[a("span",{staticClass:"plus"},[e._v("+")]),a("el-button",{attrs:{type:"text"}},[e._v("添加产品")])],1)],2),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.page.no,"page-size":e.page.size,"page-sizes":[5,10,20],total:e.page.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.basePageChange}})],1)])])],1),a("div",{staticClass:"form-btns"},[a("el-button",{on:{click:e.cancel}},[e._v("完成")]),"edit"===e.todo?a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]):e._e()],1)],1)])},i=[],l=(a("7f7f"),a("c5f6"),a("ac6a"),a("2ef0")),o=a("7609"),n=a("365c"),c=a("6a47"),r={name:"DialogNewOrder",components:{CustomerNameSelector:c["a"]},data:function(){return{delVisible:!1,id:"",process:1,todo:"check",dict:{},form:{},taxRate:0,tableTitles:[{label:"型号",name:"type"},{label:"箱数",name:"boxes"},{label:"件数/箱",name:"pics"},{label:"售价",name:"price"},{label:"是否尾箱",name:"isTail"},{label:"总计",name:"total"}],lockCustomer:!1,goodsList:[],listOrigin:{specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1},rules:{name:[{required:!0,message:"请输入",trigger:"change"}],transportName:[{required:!0,message:"请输入",trigger:"change"}]},page:{no:1,size:5,total:0}}},created:function(){this.dict=o["a"],this.getTaxRate()},mounted:function(){console.log(this.$route.params),this.id=this.$route.params.id,this.getData()},methods:{approval:function(){var e=this;this.delVisible=!1;var t={id:this.id,status:2};Object(n["g"])(t).then((function(t){e.$message.success("审核通过完成"),e.getData()}))},getData:function(){var e=this;Object(n["R"])({id:this.id}).then((function(t){var a=t.details,s=t.id,i=t.customerId,l=t.customerName,o=t.customerAddress,n=t.transportName,c=t.payType,r=t.monetaryUnit,u=t.discount,m=t.exchangeRate,d=t.taxRate,p=(t.createTime,t.process),f=t.companyName,v=t.companyId;a.forEach((function(e){e.isTail=1==e.isTail}));var h={id:s,customerId:i,customerName:l,customerAddress:o,transportName:n,payType:Number(c),monetaryUnit:r,discount:u,exchangeRate:m,taxRate:d,companyName:f,companyId:v},b=a,g={form:h,goodsList:b,customerName:l};e.process=p,e.editData(g),e.setName(g.customerName)}))},changaItem:function(e,t,a){this.$set(this.goodsList[t],a,e)},addList:function(){var e=Object(l["cloneDeep"])(this.listOrigin);this.goodsList.push(e)},delList:function(e){this.goodsList.splice(e,1)},save:function(){var e=this;this.form.exchangeRate=this.taxRate;var t=Object(l["cloneDeep"])(this.form);t.goodsList=Object(l["cloneDeep"])(this.goodsList),t.goodsList.forEach((function(e){e.isTail?e.isTail=1:e.isTail=0})),Object(n["n"])(t).then((function(t){e.$message.success("操作成功"),e.todo="check",e.getData()}))},resetData:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.customerId?this.lockCustomer=!0:this.lockCustomer=!1,this.form={customerId:e.customerId||"",customerName:e.customerName||"",customerAddress:"",transportName:"",payType:"",monetaryUnit:"",discount:"1",exchangeRate:"",taxRate:""},this.goodsList=[{specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1}],this.$nextTick((function(){a&&t.$refs.nameSelector.reset(),t.$refs.form.clearValidate()}))},setName:function(e){this.$refs.nameSelector.setName(e)},editData:function(e){var t=this;this.form=e.form,this.goodsList=e.goodsList,this.$nextTick((function(){t.$refs.form.clearValidate()}))},queryName:function(e,t){Object(n["Y"])({level:"",status:"",page:1,pageSize:10,userName:e}).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];a.push({value:i.memberName,id:i.id,memberName:i.memberName})}t(a)}))},queryProduct:function(e,t){Object(n["i"])({page:1,pageSize:5,specification:e}).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.specification,a.push(i)}t(a)}))},queryTransport:function(e,t){var a={pageSize:5,page:1,transporterName:e};Object(n["N"])(a).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.transporterName,a.push(i)}t(a)}))},queryCompany:function(e,t){var a={pageSize:5,page:1,name:e};Object(n["D"])(a).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.name,a.push(i)}t(a)}))},handleProductSelect:function(e,t){this.$set(this.goodsList[t],"goodsId",e.goodsId),this.$set(this.goodsList[t],"goodsName",e.name)},handleSelect:function(e){this.form.customerName=e.memberName,this.form.customerId=e.id,this.form.customerAddress=e.address},handleSelectCompany:function(e){this.form.companyName=e.name,this.form.companyId=e.id},getTaxRate:function(){var e=this,t={status:"taxRate"};Object(n["M"])(t).then((function(t){var a=t instanceof Array?t:[];e.taxRate=a[0].configValue}))},basePageChange:function(e){this.$set(this.page,"no",e),this.getData()},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},edit:function(){this.todo="edit"},cancel:function(){this.$router.push({name:"order"})}}},u=r,m=(a("bd88"),a("2877")),d=Object(m["a"])(u,s,i,!1,null,"a65d071c",null);t["default"]=d.exports},"6a47":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"autocomplete-area"},[a("el-autocomplete",{staticClass:"form-input",style:"width: "+e.width,attrs:{disabled:e.disabled,size:"mini","fetch-suggestions":e.queryName,maxlength:15,"show-word-limit":"",placeholder:"请输入客户名"},on:{select:e.handleSelect},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)},i=[],l=a("365c"),o={name:"CustomerNameSelector",props:{width:"",disabled:!1},data:function(){return{form:{name:""}}},methods:{queryName:function(e,t){Object(l["Y"])({level:"",status:"",page:1,pageSize:5,userName:e}).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.memberName,a.push(i)}t(a)}))},handleSelect:function(e){this.$emit("selectData",e)},setName:function(e){this.$set(this.form,"name",e)},reset:function(){this.form.name=""}}},n=o,c=(a("c2db"),a("2877")),r=Object(c["a"])(n,s,i,!1,null,null,null);t["a"]=r.exports},"6e41":function(e,t,a){},"72e4":function(e,t,a){"use strict";var s=a("c027"),i=a.n(s);i.a},7609:function(e,t,a){"use strict";var s={accountType:[{value:0,label:"现金"},{value:1,label:"转账"},{value:2,label:"微信"},{value:3,label:"发票"}],payWay:[{value:0,label:"发票"},{value:1,label:"汇款"}],payENWay:[{value:0,label:"INVOICE"},{value:1,label:"CASH"}],payStatus:[{value:0,label:"未支付"},{value:1,label:"已支付"},{value:2,label:"欠款"},{value:3,label:"已结欠"}],payENStatus:[{value:0,label:"PAID"},{value:1,label:"UNPAID"}],soldStatus:[{value:"",label:"预录入"},{value:0,label:"即将到货"},{value:1,label:"现货"},{value:2,label:"售罄"}],settingItemValue:[{value:5,label:"特色/Special"},{value:0,label:"颜色/Color"},{value:1,label:"尺码/Size"},{value:2,label:"面料/Material"},{value:4,label:"配比/Ratio"}],containerStatus:[{value:0,label:"未运输"},{value:1,label:"已发货"},{value:2,label:"已到达待确认"},{value:3,label:"已确认货物"}],transportType:[{value:0,label:"海运"},{value:1,label:"陆运"},{value:2,label:"空运"},{value:3,label:"其他"}],getDict:function(e,t){for(var a=0;a<s[t].length;a++){var i=s[t][a];if(i.value==e)return i.label}}};t["a"]=s},"7ea1":function(e,t,a){},"85f2":function(e,t,a){e.exports=a("454f")},"95c3":function(e,t,a){"use strict";var s=a("1a72"),i=a.n(s);i.a},bd86:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("85f2"),i=a.n(s);function l(e,t,a){return t in e?i()(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},bd88:function(e,t,a){"use strict";var s=a("6e41"),i=a.n(s);i.a},c027:function(e,t,a){},c2db:function(e,t,a){"use strict";var s=a("7ea1"),i=a.n(s);i.a},de9e:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px",inline:!0}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[e._v("* ")]),e._v("客户")]),a("customer-name-selector",{ref:"nameSelector",staticStyle:{"margin-right":"90px"},attrs:{width:"200px",disabled:e.lockCustomer},on:{selectData:e.handleSelect}})],1),a("el-form-item",{attrs:{label:"地址",prop:"customerAddress"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:e.form.customerAddress,callback:function(t){e.$set(e.form,"customerAddress",t)},expression:"form.customerAddress"}})],1),a("el-form-item",{attrs:{label:"托运部",prop:"transportName"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":e.queryTransport,placeholder:"请输入"},model:{value:e.form.transportName,callback:function(t){e.$set(e.form,"transportName",t)},expression:"form.transportName"}})],1),a("el-form-item",{attrs:{label:"公司",prop:"company"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":e.queryCompany,placeholder:"请输入"},on:{select:e.handleSelectCompany},model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName",t)},expression:"form.companyName"}})],1),a("el-form-item",{attrs:{label:"支付方式",prop:"payType"}},[a("el-select",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请选择"},model:{value:e.form.payType,callback:function(t){e.$set(e.form,"payType",t)},expression:"form.payType"}},e._l(e.dict.payWay,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"货币",prop:"monetaryUnit"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:e.form.monetaryUnit,callback:function(t){e.$set(e.form,"monetaryUnit",t)},expression:"form.monetaryUnit"}})],1),a("el-form-item",{attrs:{label:"折扣",prop:"discount"}},[a("el-input",{staticClass:"form-input",attrs:{max:1,size:"mini",placeholder:"请输入0-1，例如八折为0.8"},model:{value:e.form.discount,callback:function(t){e.$set(e.form,"discount",t)},expression:"form.discount"}})],1),a("el-form-item",{attrs:{label:"税率",prop:"taxRate"}},[a("el-input",{staticClass:"form-input",attrs:{max:1,size:"mini",placeholder:"请输入小数，例如0.11"},model:{value:e.form.taxRate,callback:function(t){e.$set(e.form,"taxRate",t)},expression:"form.taxRate"}})],1)],1),a("div",{staticClass:"prod-table"},[a("div",{staticClass:"label"},[e._v("产品")]),a("div",{staticClass:"table-area"},[a("div",{staticClass:"table-head"},e._l(e.tableTitles,(function(t,s){return a("div",{key:s,staticClass:"head-item"},[e._v(e._s(t.label))])})),0),e._l(e.goodsList,(function(t,s){return a("div",{key:s,staticClass:"table-list"},[a("div",{staticClass:"list-item"},[a("el-autocomplete",{attrs:{size:"mini","fetch-suggestions":e.queryProduct,placeholder:"请输入产品名"},on:{select:function(t){e.handleProductSelect(t,s)}},model:{value:t.specification,callback:function(a){e.$set(t,"specification",a)},expression:"list.specification"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{on:{change:function(a){return e.changaItem(t.caseNum,s,"caseNum")}},model:{value:t.caseNum,callback:function(a){e.$set(t,"caseNum",a)},expression:"list.caseNum"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{on:{change:function(a){return e.changaItem(t.goodsTotal,s,"goodsTotal")}},model:{value:t.goodsTotal,callback:function(a){e.$set(t,"goodsTotal",a)},expression:"list.goodsTotal"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{on:{change:function(a){return e.changaItem(t.goodsPrice,s,"goodsPrice")}},model:{value:t.goodsPrice,callback:function(a){e.$set(t,"goodsPrice",a)},expression:"list.goodsPrice"}})],1),a("div",{staticClass:"list-item"},[a("el-checkbox",{model:{value:t.isTail,callback:function(a){e.$set(t,"isTail",a)},expression:"list.isTail"}})],1),a("div",{staticClass:"list-item"},[e._v("\n                    "+e._s(t.caseNum*t.goodsTotal*t.goodsPrice||0)+"\n                ")]),a("div",{staticClass:"del-btn",on:{click:function(t){return e.delList(s)}}},[a("el-button",{attrs:{type:"text",icon:"el-icon-close"}})],1)])})),a("div",{staticClass:"add-btn",on:{click:e.addList}},[a("span",{staticClass:"plus"},[e._v("+")]),a("el-button",{attrs:{type:"text"}},[e._v("添加产品")])],1)],2)])],1)},i=[],l=(a("7f7f"),a("ac6a"),a("2ef0")),o=a("7609"),n=a("365c"),c=a("6a47"),r={name:"DialogNewOrder",components:{CustomerNameSelector:c["a"]},data:function(){return{dict:{},form:{},taxRate:0,tableTitles:[{label:"型号",name:"type"},{label:"箱数",name:"boxes"},{label:"件数/箱",name:"pics"},{label:"售价",name:"price"},{label:"是否尾箱",name:"isTail"},{label:"总计",name:"total"}],lockCustomer:!1,goodsList:[],listOrigin:{specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1},rules:{name:[{required:!0,message:"请输入",trigger:"change"}],transportName:[{required:!0,message:"请输入",trigger:"change"}]}}},created:function(){this.dict=o["a"],this.getTaxRate()},methods:{changaItem:function(e,t,a){this.$set(this.goodsList[t],a,e)},addList:function(){var e=Object(l["cloneDeep"])(this.listOrigin);this.goodsList.push(e)},delList:function(e){this.goodsList.splice(e,1)},saveSubmit:function(){this.form.exchangeRate=this.taxRate;var e=Object(l["cloneDeep"])(this.form);e.goodsList=Object(l["cloneDeep"])(this.goodsList),e.goodsList.forEach((function(e){e.isTail?e.isTail=1:e.isTail=0})),this.$emit("saveData",e)},resetData:function(e){var t=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.customerId?this.lockCustomer=!0:this.lockCustomer=!1,this.form={customerId:e.customerId||"",customerName:e.customerName||"",customerAddress:"",transportName:"",payType:"",monetaryUnit:"",discount:"1",exchangeRate:"",taxRate:"",companyName:"",companyId:""},this.goodsList=[{specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1}],this.$nextTick((function(){a&&t.$refs.nameSelector.reset(),t.$refs.form.clearValidate()}))},setName:function(e){this.$refs.nameSelector.setName(e)},editData:function(e){var t=this;this.form=e.form,this.goodsList=e.goodsList,this.$nextTick((function(){t.$refs.form.clearValidate()}))},queryName:function(e,t){Object(n["Y"])({level:"",status:"",page:1,pageSize:10,userName:e}).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];a.push({value:i.memberName,id:i.id,memberName:i.memberName})}t(a)}))},queryProduct:function(e,t){Object(n["i"])({page:1,pageSize:5,specification:e}).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.specification,a.push(i)}t(a)}))},queryTransport:function(e,t){var a={pageSize:5,page:1,transporterName:e};Object(n["N"])(a).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.transporterName,a.push(i)}t(a)}))},queryCompany:function(e,t){var a={pageSize:5,page:1,name:e};Object(n["D"])(a).then((function(e){for(var a=[],s=0;s<e.records.length;s++){var i=e.records[s];i.value=i.name,a.push(i)}t(a)}))},handleProductSelect:function(e,t){this.$set(this.goodsList[t],"goodsId",e.goodsId),this.$set(this.goodsList[t],"goodsName",e.name)},handleSelect:function(e){this.form.customerName=e.memberName,this.form.customerId=e.id},handleSelectCompany:function(e){this.form.companyName=e.name,this.form.companyId=e.id},getTaxRate:function(){var e=this,t={status:"taxRate"};Object(n["M"])(t).then((function(t){var a=t instanceof Array?t:[];e.taxRate=a[0].configValue}))}}},u=r,m=(a("95c3"),a("2877")),d=Object(m["a"])(u,s,i,!1,null,"3a4b0642",null);t["a"]=d.exports},ed8d:function(e,t,a){"use strict";var s=a("4c8d"),i=a.n(s);i.a},f1cd:function(e,t,a){"use strict";var s=a("0530"),i=a.n(s);i.a},f74d:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-selector"},[a("div",{staticClass:"date"},[a("el-select",{ref:"selector",attrs:{placeholder:e.placeholder},on:{change:e.change},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"showDate",style:"width:"+e.width,on:{click:e.dateClick}},[e._v("\n        "+e._s(e.showValue?e.showValue:e.placeholder)+"\n        "),a("span",{staticClass:"unfold-pic"})])])},i=[],l={name:"DateSelector",props:{placeholder:String,options:Array,width:{type:String,default:"83px"}},data:function(){return{value:"",showValue:""}},mounted:function(){},methods:{dateClick:function(){console.log(this.$refs),this.$refs.selector.focus()},change:function(e){console.log(e);for(var t=0;t<this.options.length;t++){var a=this.options[t];if(a.value==e){this.showValue=a.label;break}}this.$emit("change",e)}}},o=l,n=(a("72e4"),a("2877")),c=Object(n["a"])(o,s,i,!1,null,"f8f72a3c",null);t["a"]=c.exports}}]);