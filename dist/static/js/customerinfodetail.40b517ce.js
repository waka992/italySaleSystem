(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["customerinfodetail"],{"157c":function(t,e,a){"use strict";var s=a("ca70"),l=a.n(s);l.a},"1a72":function(t,e,a){},"2a72":function(t,e,a){"use strict";var s=a("ee6f"),l=a.n(s);l.a},"3fce":function(t,e,a){},"40b2":function(t,e,a){},4126:function(t,e,a){"use strict";var s=a("3fce"),l=a.n(s);l.a},"4e21":function(t,e,a){},5516:function(t,e,a){},"6a47":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"autocomplete-area"},[a("el-autocomplete",{staticClass:"form-input",style:"width: "+t.width,attrs:{disabled:t.disabled,size:"mini","fetch-suggestions":t.queryName,maxlength:15,"show-word-limit":"",placeholder:"请输入客户名"},on:{select:t.handleSelect},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)},l=[],i=a("365c"),o={name:"CustomerNameSelector",props:{width:"",disabled:!1},data:function(){return{form:{name:""}}},methods:{queryName:function(t,e){Object(i["Y"])({level:"",status:"",page:1,pageSize:5,userName:t}).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var l=t.records[s];l.value=l.memberName,a.push(l)}e(a)}))},handleSelect:function(t){this.$emit("selectData",t)},setName:function(t){this.$set(this.form,"name",t)},reset:function(){this.form.name=""}}},n=o,c=(a("c2db"),a("2877")),r=Object(c["a"])(n,s,l,!1,null,null,null);e["a"]=r.exports},"72e4":function(t,e,a){"use strict";var s=a("c027"),l=a.n(s);l.a},7609:function(t,e,a){"use strict";var s={accountType:[{value:0,label:"现金"},{value:1,label:"转账"},{value:2,label:"微信"},{value:3,label:"发票"}],payWay:[{value:0,label:"发票"},{value:1,label:"汇款"}],payENWay:[{value:0,label:"INVOICE"},{value:1,label:"CASH"}],payStatus:[{value:0,label:"未支付"},{value:1,label:"已支付"},{value:2,label:"欠款"},{value:3,label:"已结欠"}],payENStatus:[{value:0,label:"PAID"},{value:1,label:"UNPAID"}],soldStatus:[{value:"",label:"预录入"},{value:0,label:"即将到货"},{value:1,label:"现货"},{value:2,label:"售罄"}],settingItemValue:[{value:5,label:"特色/Special"},{value:0,label:"颜色/Color"},{value:1,label:"尺码/Size"},{value:2,label:"面料/Material"},{value:4,label:"配比/Ratio"}],containerStatus:[{value:0,label:"未运输"},{value:1,label:"已发货"},{value:2,label:"已到达待确认"},{value:3,label:"已确认货物"}],transportType:[{value:0,label:"海运"},{value:1,label:"陆运"},{value:2,label:"空运"},{value:3,label:"其他"}],getDict:function(t,e){for(var a=0;a<s[e].length;a++){var l=s[e][a];if(l.value==t)return l.label}}};e["a"]=s},"7ea1":function(t,e,a){},8398:function(t,e,a){},8949:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{name:"customerinfo"}}},[t._v("客户信息")]),a("el-breadcrumb-item",[t._v("客户信息详情")])],1),a("div",{staticClass:"operate-btns"},[a("el-button",{staticClass:"btn3 outer",on:{click:function(e){return t.showDialog("balance")}}},[t._v("结欠")]),a("el-button",{staticClass:"btn2 outer",on:{click:function(e){return t.showDialog("bill")}}},[t._v("账单总汇")]),a("el-button",{staticClass:"btn2 outer",on:{click:function(e){return t.showDialog("sold")}}},[t._v("销售统计")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"detail-card"},[a("div",{staticClass:"title"},[t._v(t._s(t.comInfo.memberName))]),a("div",{staticClass:"handle-box"}),a("el-row",{staticClass:"detail-row"},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("地址：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(t.comInfo.address))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("电话：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(t.comInfo.mobile))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("银行信息：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(t.comInfo.bank))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("初始欠款：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(t.comInfo.arrears))])])],1),a("el-row",{staticClass:"detail-row"},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("会员昵称：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(t.comInfo.appName))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("等级：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(1==t.comInfo.level?"游客":2==t.comInfo.level?"普通":3==t.comInfo.level?"VIP":""))])]),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"detail-label"},[t._v("状态：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(1==t.comInfo.status?"激活":"注销"))])])],1),a("el-row",{staticClass:"detail-row"},[a("el-col",{attrs:{span:18}},[a("span",{staticClass:"detail-label"},[t._v("备忘：")]),a("span",{staticClass:"detail-content"},[t._v(t._s(t.comInfo.remarks))])])],1)],1),a("div",{staticClass:"record-card"},[a("div",{staticClass:"top"},[a("div",{staticClass:"title"},[t._v("销售记录")]),a("div",{staticClass:"operate-btns"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showDialog("new")}}},[t._v("+添加订单")])],1)]),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,stripe:"","header-cell-class-name":"table-header"},on:{"selection-change":t.soldRecordChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.dateFormat(e.row.createTime))+"\n                    ")]}}])}),a("el-table-column",{attrs:{prop:"caseNum",label:"箱数",align:"center"}}),a("el-table-column",{attrs:{prop:"price",label:"销售金额",align:"center"}}),a("el-table-column",{attrs:{label:"支付状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(t.getDict(e.row.status,"payStatus"))+"\n                    ")]}}])}),a("el-table-column",{attrs:{label:"审核状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(0==e.row.process||null==e.row.process?"待审核":1==e.row.process?"不通过":2==e.row.process?"待发货":3==e.row.process?"欠款":"仓库发货")+"\n                    ")]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.showDialog("edit",e.row.id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.showDialog("pay",e.row.id)}}},[t._v("支付")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.page.no,"page-size":t.page.size,"page-sizes":[5,10,20],total:t.page.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.basePageChange}})],1)],1)]),a("div",{staticClass:"bottom-box"},[a("div",{staticClass:"inner-box"},[a("div",{staticClass:"left-box"},[a("div",{staticClass:"box-title"},[t._v("欠款总汇")]),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.deptTableData,stripe:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"price",label:"总金额",align:"center"}}),a("el-table-column",{attrs:{prop:"startArrears",label:"初始欠款",align:"center"}}),a("el-table-column",{attrs:{prop:"goodsTotal",label:"件数",align:"center",width:"80"}}),a("el-table-column",{attrs:{prop:"collection",label:"总收款",align:"center",width:"80"}}),a("el-table-column",{attrs:{prop:"arrears",label:"余数",align:"center",width:"80"}})],1)],1),a("div",{staticClass:"right-box"},[a("div",{staticClass:"box-title"},[t._v("收款总汇")]),a("div",{staticClass:"box-operate"}),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.receiveTableData,stripe:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"date",label:"日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                            "+t._s(t.dateFormat(e.row.createTime))+"\n                        ")]}}])}),a("el-table-column",{attrs:{prop:"payWay",label:"收款方式",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                            "+t._s(t.getDict(e.row.payWay,"payWay"))+"\n                        ")]}}])}),a("el-table-column",{attrs:{prop:"value",label:"金额",align:"center"}}),a("el-table-column",{attrs:{prop:"totalValue",label:"总金额",align:"center"}})],1)],1)])]),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!1,title:"新订单",visible:t.newOrderDialog,width:"830px"},on:{"update:visible":function(e){t.newOrderDialog=e}}},[a("dialog-new-order",{ref:"newOrderDialogRef",on:{saveData:t.saveSubmit}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(e){t.newOrderDialog=!1}}},[t._v("取消")]),a("el-button",{staticClass:"curr-btn",attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")])],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!0,title:"结欠",visible:t.balanceDialog,width:"400px"},on:{"update:visible":function(e){t.balanceDialog=e}}},[a("dialog-balance",{ref:"balanceDialogRef",on:{balance:t.askBalance}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(e){t.balanceDialog=!1}}},[t._v("取消")]),a("el-button",{staticClass:"curr-btn",attrs:{type:"primary"},on:{click:t.getBalance}},[t._v("结欠")])],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!0,title:"账单总汇",visible:t.billDialog,width:"830px"},on:{"update:visible":function(e){t.billDialog=e}}},[a("dialog-bill",{ref:"billDialog",on:{getPDF:t.receiveBillPDF}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(e){t.billDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.getBillPDF}},[t._v("生成PDF")])],1)],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!0,title:"销售统计",visible:t.soldDialog,width:"830px"},on:{"update:visible":function(e){t.soldDialog=e}}},[a("dialog-sold",{ref:"soldDialog"})],1),a("el-dialog",{staticClass:"custom-dialog",attrs:{"close-on-click-modal":!1,"show-close":!0,title:"支付订单",visible:t.payDialog,width:"400px"},on:{"update:visible":function(e){t.payDialog=e}}},[a("dialog-pay",{ref:"payDialog",on:{pay:t.askPay}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"curr-btn",attrs:{plain:""},on:{click:function(e){t.payDialog=!1}}},[t._v("取消")]),a("el-button",{staticClass:"curr-btn",attrs:{type:"primary"},on:{click:t.getPay}},[t._v("支付")])],1)],1)],1)},l=[],i=(a("c5f6"),a("ac6a"),a("c1df")),o=a.n(i),n=a("7609"),c=a("de9e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dialog-bill"},[a("div",{staticClass:"language"},[a("common-selector",{attrs:{width:"70px",placeholder:"请选择语言",options:[{label:"中文版本",value:"CN"},{label:"English",value:"EN"}]},on:{change:t.languageChange}})],1),a("div",{staticClass:"bill-form"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"title"},[t._v(t._s(t.labels.customerName))]),a("span",{staticClass:"value"},[t._v(t._s(t.form.name))])]),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"title"},[t._v(t._s(t.labels.supplier))]),a("span",{staticClass:"value"},[t._v(t._s(t.form.seller))])])],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"title"},[t._v(t._s(t.labels.date))]),"CN"==t.language?a("span",{staticClass:"value"},[t._v(t._s(t.dateFormat(t.form.date,"CN")))]):a("span",{staticClass:"value"},[t._v(t._s(t.dateFormat(t.form.date,"EN")))])])],1)],1),t._l(t.tableList,(function(e,s){return a("div",{key:s,staticClass:"prod-table"},[a("div",{staticClass:"table-area"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"title"},[t._v(t._s(t.labels.soldDate))]),"CN"==t.language?a("span",{staticClass:"value"},[t._v(t._s(t.dateFormat(e.createTime)))]):a("span",{staticClass:"value"},[t._v(t._s(t.dateFormat(e.createTime,"EN")))])])],1),a("div",{staticClass:"table-head"},t._l(t.tableTitles,(function(e,s){return a("div",{key:s,staticClass:"head-item"},[t._v(t._s(e.label))])})),0),t._l(e.details,(function(e,s){return a("div",{key:s,staticClass:"table-list",class:s%2==0?"odd":"double"},[a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.specification)+"\n                ")]),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.caseNum)+"\n                ")]),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.goodsTotal)+"\n                ")]),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.goodsPrice)+"\n                ")]),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.caseNum*e.goodsTotal*e.goodsPrice||0)+"\n                    ")])])})),a("div",{staticClass:"statistics",class:t.tableList.length>1?"multi":""},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.totalSum))]),a("div",{staticClass:"item-value"},[t._v(t._s(e.price))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.payStatus))]),"CN"==t.language?a("div",{staticClass:"item-value"},[t._v(t._s(t.getDict(e.status,"payStatus")))]):a("div",{staticClass:"item-value"},[t._v(t._s(t.getDict(e.status,"payENStatus")))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.discount))]),a("div",{staticClass:"item-value"},[t._v(t._s(e.discount))])])])],2)])})),t.tableList.length>1?a("div",{staticClass:"total-statistics"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.totalPics))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.totalPics))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.totalBoxes))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.totalBoxes))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.labels.allTotalSum))]),a("div",{staticClass:"item-value"},[t._v(t._s(t.totalValue))])])]):t._e()],2)},u=[],d=(a("7f7f"),a("2ef0")),m=a("f74d"),p={name:"DialogBill",components:{CommonSelector:m["a"]},data:function(){return{language:"CN",totalPics:2200,totalBoxes:2300,totalValue:2800,payStatus:0,form:{name:"",seller:"",date:""},labels:{},tableTitles:[],tableList:[]}},created:function(){this.getDict=n["a"].getDict},methods:{getPDF:function(){var t=Object(d["cloneDeep"])(this.form);t.product=Object(d["cloneDeep"])(this.tableList),this.$emit("getPDF",t)},resetData:function(t){var e=t.res;this.languageChange("CN"),this.form={name:t.name,seller:"",date:t.date},this.totalPics=0,this.totalBoxes=0,this.totalValue=0,console.log(e),this.tableList=e;for(var a=0;a<e.length;a++){var s=e[a];this.totalPics+=Number(s.goodsTotal),this.totalBoxes+=Number(s.caseNum),this.totalValue+=Number(s.price)}},languageChange:function(t){this.language=t,"CN"==t&&(this.tableTitles=[{label:"货品型号"},{label:"箱数"},{label:"件数"},{label:"售价"},{label:"金额"}],this.labels={customerName:"客户名称",date:"账单日期",soldDate:"销售日期",supplier:"销售方",totalSum:"总销售金额",payStatus:"支付状态",totalPics:"总销售件数",totalBoxes:"总销售箱数",allTotalSum:"总销售金额",discount:"折扣"}),"EN"==t&&(this.tableTitles=[{label:"Article Number"},{label:"Box"},{label:"Piece"},{label:"Price"},{label:"Sum"}],this.labels={customerName:"Costumer",date:"Date",soldDate:"Sold Date",supplier:"Supplier",totalSum:"Total Sum",payStatus:"Payment Status",totalPics:"Total Pieces",totalBoxes:"Total Boxes",allTotalSum:"Total Sum",discount:"Discount"})},dateFormat:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CN";return"CN"==e?o()(t).format("YYYY-MM-DD"):"EN"==e?o()(t).format("YYYY/MM/DD"):void 0}}},f=p,h=(a("4126"),a("2877")),v=Object(h["a"])(f,r,u,!1,null,"191fde0c",null),b=v.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dialog-sold"},[a("div",{staticClass:"date-area"},[a("date-selector",{ref:"dateSelector",on:{change:t.getDateRange}})],1),a("div",{staticClass:"top-switch"},t._l(t.switchs,(function(e,s){return a("div",{key:s,staticClass:"item",class:s==t.selectedSwitch?"selected":"",on:{click:function(e){return t.selectSwitch(s)}}},[t._v(t._s(e.label)+"\n        ")])})),0),a("div",{staticClass:"second-switch"},t._l(t.dateSwitchs,(function(e,s){return a("div",{key:s,staticClass:"item",class:s==t.selectedDateSwitch?"selected":"",on:{click:function(e){return t.selectDateSwitch(s)}}},[t._v(t._s(e.label)+"\n        ")])})),0),a("statistics-pie",{ref:"pieChart",staticClass:"charts",attrs:{height:"325px"}}),a("div",{staticClass:"bottom-value"},[a("div",{staticClass:"title"},[t._v("总汇:")]),a("div",{staticClass:"items"},[a("div",{staticClass:"inner"},[a("div",{staticClass:"item"},[a("span",{staticClass:"item-title"},[t._v("客户名")]),a("span",{staticClass:"item-content"},[t._v(t._s(t.total.name))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"item-title"},[t._v("总销售金额")]),a("span",{staticClass:"item-content"},[t._v(t._s(t.total.value))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"item-title"},[t._v("总销售件数")]),a("span",{staticClass:"item-content"},[t._v(t._s(t.total.pics))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"item-title"},[t._v("总销售箱数")]),a("span",{staticClass:"item-content"},[t._v(t._s(t.total.boxes))])])])])])],1)},C=[],y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pie-chart-box"},[a("div",{staticClass:"pie-chart",style:"height:"+t.height,attrs:{id:"pie-chart"}})])},D=[],_=a("63e3"),w={name:"StatisticsPie",props:{height:{type:String,default:"213px"},width:{type:String,default:"213px"}},data:function(){return{chart:null}},mounted:function(){this.initCharts()},methods:{initCharts:function(){var t=null;if(!this.chart){var e=this.$el.querySelector(".pie-chart");t=_["a"](e);var a={tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"plain",orient:"vertical",right:10,top:80,bottom:20,data:[]},series:[{name:"",type:"pie",radius:"106px",center:["30%","50%"],data:[],animation:!1,hoverAnimation:!1,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],color:["#8DCBAE","#5BE7C7","#374E5D","#D78D73","#C63D3C","#78A98A","#8776D7","#E75BDB","#EDCACF","#FFCB51","#62C0B6","#B5F687"]};t.setOption(a),this.chart=t}},setData:function(t){this.chart.setOption(t)}}},T=w,x=(a("a295"),Object(h["a"])(T,y,D,!1,null,"d6b34880",null)),N=x.exports,S=a("d0c2"),k=a("365c"),$={name:"DialogSold",components:{StatisticsPie:N,DateSelector:S["a"]},data:function(){return{attrType:0,dateType:0,date:"",id:"",selectedSwitch:0,switchs:[{label:"特色统计"},{label:"销售统计"}],selectedDateSwitch:0,dateSwitchs:[{label:"周"},{label:"月"},{label:"季"},{label:"年"}],total:{name:"",value:"",pics:"",boxes:""}}},created:function(){this.getDict=n["a"].getDict},mounted:function(){this.setChartData()},methods:{setId:function(t){this.id=t,this.resetData()},setName:function(t){this.total.name=t},resetData:function(){var t=this;this.attrType=0,this.dateType=0,this.date="",this.selectedSwitch=0,this.selectedDateSwitch=0,this.total={name:"",value:"",pics:"",boxes:""},this.$nextTick((function(){t.$refs.dateSelector.resetDate()}))},getData:function(){var t=this,e={type:this.dateType,STime:this.date||o()().format("YYYY-MM-DD"),id:this.id};Object(k["q"])(e).then((function(e){for(var a=e.label,s=e.sale,l=e.sum,i=0;i<s.length;i++){var o=s[i];o.caseNum=o.CASENUM,o.price=o.PRICE;var n=0==t.dateType?"周":1==t.dateType?"月":2==t.dateType?"季":3==t.dateType?"年":"";o.label=o.days+n}var c=[];0==t.attrType&&(c=a),1==t.attrType&&(c=s),t.total.value=l.PRICE,t.total.pics=l.GOODSTOTAL,t.total.boxes=l.CASENUM,t.setChartData(c)}))},selectSwitch:function(t){this.selectedSwitch=t,this.topSwitchHandle(t)},selectDateSwitch:function(t){this.selectedDateSwitch=t,this.timeSwitchHandle(t)},topSwitchHandle:function(t){this.attrType=t,this.getData()},timeSwitchHandle:function(t){this.dateType=t,this.getData()},getDateRange:function(t){t&&(this.date=o()(t).format("YYYY-MM-DD"),this.getData())},setChartData:function(t){for(var e=[],a=Object(d["cloneDeep"])(t),s=0;s<t.length;s++){var l=t[s];e.push(l.label),a[s].name=l.label,a[s].value=l.caseNum}console.log(e),console.log(a);var i=[];if(e.length<6)i={data:e,orient:"vertical",right:10,top:80,bottom:20,formatter:function(t){var s=0,l=e;return l.forEach((function(e,a){e==t&&(s=a)})),t+" "+a[s].caseNum+"箱  "+a[s].price}};else for(var o=Math.ceil(e.length/6),n=o;n>0;n--)i.push({orient:"vertical",top:80,bottom:20,right:152*(n-1)+"px",data:e.slice(6*(o-n),6*(o-n+1)),formatter:function(t){var s=0,l=e;return l.forEach((function(e,a){e==t&&(s=a)})),t+" "+a[s].caseNum+"箱  "+a[s].price}});console.log(i);var c={legend:i,series:[{label:{formatter:function(t){var e=t.data;return e.name+"-"+e.value+"箱 "}},data:a}]};this.$refs.pieChart.setData(c)}}},O=$,I=(a("157c"),Object(h["a"])(O,g,C,!1,null,"5bc230f4",null)),P=I.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"结欠金额",prop:"amount"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),a("el-form-item",{attrs:{label:"资金来源",prop:"accountType"}},[a("el-select",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请选择"},model:{value:t.form.accountType,callback:function(e){t.$set(t.form,"accountType",e)},expression:"form.accountType"}},t._l(t.dict.accountType,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1)],1)],1)},E=[],j={name:"DialogBalance",components:{},data:function(){return{dict:{},form:{amount:0,accountType:0},rules:{amount:[{required:!0,message:"请输入",trigger:"change"}]}}},created:function(){this.dict=n["a"]},methods:{sendData:function(){this.$emit("balance",this.form)},resetData:function(){var t=this;this.form.amount=0,this.form.accountType=0,this.$nextTick((function(){t.$refs.form.clearValidate()}))}}},z=j,Y=(a("c6c9"),Object(h["a"])(z,R,E,!1,null,"7617e28c",null)),B=Y.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"支付金额",prop:"amount"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),a("el-form-item",{attrs:{label:"支付方式",prop:"payType"}},[a("el-select",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请选择"},model:{value:t.form.payType,callback:function(e){t.$set(t.form,"payType",e)},expression:"form.payType"}},t._l(t.dict.accountType,(function(t,e){return a("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1)],1)],1)],1)},A=[],F={name:"DialogPay",components:{},data:function(){return{id:"",dict:{},form:{amount:0,payType:""},rules:{amount:[{required:!0,message:"请输入",trigger:"change"}],payType:[{required:!0,message:"请选择",trigger:"change"}]}}},created:function(){this.dict=n["a"]},methods:{sendData:function(){var t={orderId:this.id,money:this.form.amount,payType:this.form.payType,ossFilePathName:"",pic:""};this.$emit("pay",t)},setId:function(t){this.id=t},resetData:function(){var t=this;this.form={amount:0,payType:""},this.$nextTick((function(){t.$refs.form.clearValidate()}))}}},M=F,q=(a("2a72"),Object(h["a"])(M,L,A,!1,null,"27faaba8",null)),V=q.exports,U={name:"CustomerInfoDetail",components:{DialogNewOrder:c["a"],DialogBill:b,DialogSold:P,DialogBalance:B,DialogPay:V},data:function(){return{id:"",newOrderDialog:!1,billDialog:!1,balanceDialog:!1,soldDialog:!1,payDialog:!1,page:{no:1,total:0,size:10},comInfo:{},tableData:[],deptTableData:[],receiveTableData:[],selectedRecord:[]}},created:function(){this.getDict=n["a"].getDict;var t=this.$route.params.data;this.id=t.id,this.comInfo={id:t.id,memberName:t.memberName,address:t.address,mobile:t.mobile,bank:t.bank,arrears:t.arrears,appName:t.appName,remarks:t.remarks,level:t.level,status:t.status},this.getData()},methods:{getDetail:function(){this.form={name:"广东沈外贸科技有限公司",address:"广州白云区家和",mobile:"1377292010",otherContact:"390525235@qq.com",remark:"外贸科技供应商",payStatus:"+8000",use:"文案文案"}},getData:function(){var t=this;if(this.id){var e={pageSize:this.page.size,page:this.page.no,customerId:this.id};Object(k["H"])(e).then((function(e){if(e.list){var a=e.list;t.tableData=a.records,t.page.total=a.total,t.page.no=a.current}if(e.arrears){var s=e.arrears;t.deptTableData=[s]}}))}},basePageChange:function(t){this.$set(this.page,"no",t),this.getData()},handleSizeChange:function(t){this.$set(this.page,"size",t),this.$set(this.page,"no",1),this.getData()},save:function(){this.$refs.newOrderDialogRef.saveSubmit()},saveSubmit:function(t){var e=this;t.process=0,Object(k["n"])(t).then((function(t){e.$message.success("操作成功"),e.newOrderDialog=!1,e.getData()}))},soldRecordChange:function(t){this.selectedRecord=t},getBalance:function(){this.$refs.balanceDialogRef.sendData()},askBalance:function(t){for(var e=this,a=[],s=0;s<this.selectedRecord.length;s++){var l=this.selectedRecord[s];a.push(l.id)}var i={customerId:this.id,ids:a,price:t.amount,accountType:t.accountType};Object(k["V"])(i).then((function(t){e.balanceDialog=!1,e.$message.success("结欠成功"),e.selectedRecord=[],e.getData()}))},getPay:function(){this.$refs.payDialog.sendData()},askPay:function(t){var e=this;Object(k["S"])(t).then((function(t){e.payDialog=!1,e.$message.success("支付成功"),e.getData()}))},getBillPDF:function(){this.$refs.billDialog.getPDF()},receiveBillPDF:function(){},dateFormat:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CN";return"CN"==e?o()(t).format("YYYY.MM.DD"):"EN"==e?o()(t).format("YYYY/MM/DD"):void 0},showDialog:function(t,e){var a=this;if("balance"==t){if(!this.selectedRecord.length)return void this.$message.warning("请选择需要结欠的销售记录");this.balanceDialog=!0,this.$nextTick((function(){a.$refs.balanceDialogRef.resetData()}))}if("bill"==t){if(!this.selectedRecord.length)return void this.$message.warning("请选择需要汇总的销售记录");for(var s=[],l=0;l<this.selectedRecord.length;l++){var i=this.selectedRecord[l];s.push(i.id)}Object(k["W"])(s).then((function(t){var e={name:a.comInfo.memberName,date:o()().format("YYYY-MM-DD"),res:t.order};a.billDialog=!0,a.$nextTick((function(){a.$refs.billDialog.resetData(e)}))}))}"pay"==t&&(this.payDialog=!0,this.$nextTick((function(){a.$refs.payDialog.resetData(),a.$refs.payDialog.setId(e)}))),"sold"==t&&(this.soldDialog=!0,this.$nextTick((function(){a.$refs.soldDialog.setId(a.id),a.$refs.soldDialog.setName(a.comInfo.memberName),a.$refs.soldDialog.getData()}))),"new"==t&&(this.newOrderDialog=!0,this.$nextTick((function(){a.$refs.newOrderDialogRef.resetData({customerName:a.comInfo.memberName,customerId:a.id},!1),a.$refs.newOrderDialogRef.setName(a.comInfo.memberName)}))),"edit"==t&&Object(k["R"])({id:e}).then((function(t){var e=t.details,s=t.id,l=t.customerId,i=t.customerName,o=t.customerAddress,n=t.transportName,c=t.payType,r=t.monetaryUnit,u=t.discount,d=t.exchangeRate,m=t.taxRate;t.createTime;e.forEach((function(t){t.isTail=1==t.isTail})),a.newOrderDialog=!0;var p={id:s,customerId:l,customerName:i,customerAddress:o,transportName:n,payType:Number(c),monetaryUnit:r,discount:u,exchangeRate:d,taxRate:m},f=e;a.$nextTick((function(){var t={form:p,goodsList:f};a.$refs.newOrderDialogRef.editData(t),a.$refs.newOrderDialogRef.setName(i)}))}))}}},W=U,H=(a("d55b"),Object(h["a"])(W,s,l,!1,null,"d463e03a",null));e["default"]=H.exports},"948e":function(t,e,a){"use strict";var s=a("4e21"),l=a.n(s);l.a},"95c3":function(t,e,a){"use strict";var s=a("1a72"),l=a.n(s);l.a},a295:function(t,e,a){"use strict";var s=a("40b2"),l=a.n(s);l.a},c027:function(t,e,a){},c2db:function(t,e,a){"use strict";var s=a("7ea1"),l=a.n(s);l.a},c6c9:function(t,e,a){"use strict";var s=a("5516"),l=a.n(s);l.a},ca70:function(t,e,a){},d0c2:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-selector"},[a("div",{staticClass:"date"},[a("el-date-picker",{ref:"dateSelector",attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:t.dateChange},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),a("div",{staticClass:"showDate",on:{click:t.dateClick}},[t._v("\n        "+t._s(t.date?t.date:"请选日期")+"\n        "),a("span",{staticClass:"unfold-pic"})])])},l=[],i={name:"DateSelector",props:{},data:function(){return{date:""}},mounted:function(){},methods:{resetDate:function(){this.date=""},dateClick:function(){this.$refs.dateSelector.focus()},dateChange:function(t){this.date=t,this.$emit("change",t)}}},o=i,n=(a("948e"),a("2877")),c=Object(n["a"])(o,s,l,!1,null,"4c16e271",null);e["a"]=c.exports},d55b:function(t,e,a){"use strict";var s=a("8398"),l=a.n(s);l.a},de9e:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px",inline:!0}},[a("el-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticStyle:{color:"red"}},[t._v("* ")]),t._v("客户")]),a("customer-name-selector",{ref:"nameSelector",staticStyle:{"margin-right":"90px"},attrs:{width:"200px",disabled:t.lockCustomer},on:{selectData:t.handleSelect}})],1),a("el-form-item",{attrs:{label:"地址",prop:"customerAddress"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:t.form.customerAddress,callback:function(e){t.$set(t.form,"customerAddress",e)},expression:"form.customerAddress"}})],1),a("el-form-item",{attrs:{label:"托运部",prop:"transportName"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":t.queryTransport,placeholder:"请输入"},model:{value:t.form.transportName,callback:function(e){t.$set(t.form,"transportName",e)},expression:"form.transportName"}})],1),a("el-form-item",{attrs:{label:"公司",prop:"company"}},[a("el-autocomplete",{staticClass:"form-input",attrs:{size:"mini","fetch-suggestions":t.queryCompany,placeholder:"请输入"},on:{select:t.handleSelectCompany},model:{value:t.form.companyName,callback:function(e){t.$set(t.form,"companyName",e)},expression:"form.companyName"}})],1),a("el-form-item",{attrs:{label:"支付方式",prop:"payType"}},[a("el-select",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请选择"},model:{value:t.form.payType,callback:function(e){t.$set(t.form,"payType",e)},expression:"form.payType"}},t._l(t.dict.payWay,(function(t,e){return a("el-option",{key:e,attrs:{value:t.value,label:t.label}})})),1)],1),a("el-form-item",{attrs:{label:"货币",prop:"monetaryUnit"}},[a("el-input",{staticClass:"form-input",attrs:{size:"mini",placeholder:"请输入"},model:{value:t.form.monetaryUnit,callback:function(e){t.$set(t.form,"monetaryUnit",e)},expression:"form.monetaryUnit"}})],1),a("el-form-item",{attrs:{label:"折扣",prop:"discount"}},[a("el-input",{staticClass:"form-input",attrs:{max:1,size:"mini",placeholder:"请输入0-1，例如八折为0.8"},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),a("el-form-item",{attrs:{label:"税率",prop:"taxRate"}},[a("el-input",{staticClass:"form-input",attrs:{max:1,size:"mini",placeholder:"请输入小数，例如0.11"},model:{value:t.form.taxRate,callback:function(e){t.$set(t.form,"taxRate",e)},expression:"form.taxRate"}})],1)],1),a("div",{staticClass:"prod-table"},[a("div",{staticClass:"label"},[t._v("产品")]),a("div",{staticClass:"table-area"},[a("div",{staticClass:"table-head"},t._l(t.tableTitles,(function(e,s){return a("div",{key:s,staticClass:"head-item"},[t._v(t._s(e.label))])})),0),t._l(t.goodsList,(function(e,s){return a("div",{key:s,staticClass:"table-list"},[a("div",{staticClass:"list-item"},[a("el-autocomplete",{attrs:{size:"mini","fetch-suggestions":t.queryProduct,placeholder:"请输入产品名"},on:{select:function(e){t.handleProductSelect(e,s)}},model:{value:e.specification,callback:function(a){t.$set(e,"specification",a)},expression:"list.specification"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{on:{change:function(a){return t.changaItem(e.caseNum,s,"caseNum")}},model:{value:e.caseNum,callback:function(a){t.$set(e,"caseNum",a)},expression:"list.caseNum"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{on:{change:function(a){return t.changaItem(e.goodsTotal,s,"goodsTotal")}},model:{value:e.goodsTotal,callback:function(a){t.$set(e,"goodsTotal",a)},expression:"list.goodsTotal"}})],1),a("div",{staticClass:"list-item"},[a("el-input",{on:{change:function(a){return t.changaItem(e.goodsPrice,s,"goodsPrice")}},model:{value:e.goodsPrice,callback:function(a){t.$set(e,"goodsPrice",a)},expression:"list.goodsPrice"}})],1),a("div",{staticClass:"list-item"},[a("el-checkbox",{model:{value:e.isTail,callback:function(a){t.$set(e,"isTail",a)},expression:"list.isTail"}})],1),a("div",{staticClass:"list-item"},[t._v("\n                    "+t._s(e.caseNum*e.goodsTotal*e.goodsPrice||0)+"\n                ")]),a("div",{staticClass:"del-btn",on:{click:function(e){return t.delList(s)}}},[a("el-button",{attrs:{type:"text",icon:"el-icon-close"}})],1)])})),a("div",{staticClass:"add-btn",on:{click:t.addList}},[a("span",{staticClass:"plus"},[t._v("+")]),a("el-button",{attrs:{type:"text"}},[t._v("添加产品")])],1)],2)])],1)},l=[],i=(a("7f7f"),a("ac6a"),a("2ef0")),o=a("7609"),n=a("365c"),c=a("6a47"),r={name:"DialogNewOrder",components:{CustomerNameSelector:c["a"]},data:function(){return{dict:{},form:{},taxRate:0,tableTitles:[{label:"型号",name:"type"},{label:"箱数",name:"boxes"},{label:"件数/箱",name:"pics"},{label:"售价",name:"price"},{label:"是否尾箱",name:"isTail"},{label:"总计",name:"total"}],lockCustomer:!1,goodsList:[],listOrigin:{specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1},rules:{name:[{required:!0,message:"请输入",trigger:"change"}],transportName:[{required:!0,message:"请输入",trigger:"change"}]}}},created:function(){this.dict=o["a"],this.getTaxRate()},methods:{changaItem:function(t,e,a){this.$set(this.goodsList[e],a,t)},addList:function(){var t=Object(i["cloneDeep"])(this.listOrigin);this.goodsList.push(t)},delList:function(t){this.goodsList.splice(t,1)},saveSubmit:function(){this.form.exchangeRate=this.taxRate;var t=Object(i["cloneDeep"])(this.form);t.goodsList=Object(i["cloneDeep"])(this.goodsList),t.goodsList.forEach((function(t){t.isTail?t.isTail=1:t.isTail=0})),this.$emit("saveData",t)},resetData:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.customerId?this.lockCustomer=!0:this.lockCustomer=!1,this.form={customerId:t.customerId||"",customerName:t.customerName||"",customerAddress:"",transportName:"",payType:"",monetaryUnit:"",discount:"1",exchangeRate:"",taxRate:"",companyName:"",companyId:""},this.goodsList=[{specification:"",goodsName:"",goodsId:"",caseNum:"",goodsPrice:"",goodsTotal:"",isTail:!1}],this.$nextTick((function(){a&&e.$refs.nameSelector.reset(),e.$refs.form.clearValidate()}))},setName:function(t){this.$refs.nameSelector.setName(t)},editData:function(t){var e=this;this.form=t.form,this.goodsList=t.goodsList,this.$nextTick((function(){e.$refs.form.clearValidate()}))},queryName:function(t,e){Object(n["Y"])({level:"",status:"",page:1,pageSize:10,userName:t}).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var l=t.records[s];a.push({value:l.memberName,id:l.id,memberName:l.memberName})}e(a)}))},queryProduct:function(t,e){Object(n["i"])({page:1,pageSize:5,specification:t}).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var l=t.records[s];l.value=l.specification,a.push(l)}e(a)}))},queryTransport:function(t,e){var a={pageSize:5,page:1,transporterName:t};Object(n["N"])(a).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var l=t.records[s];l.value=l.transporterName,a.push(l)}e(a)}))},queryCompany:function(t,e){var a={pageSize:5,page:1,name:t};Object(n["D"])(a).then((function(t){for(var a=[],s=0;s<t.records.length;s++){var l=t.records[s];l.value=l.name,a.push(l)}e(a)}))},handleProductSelect:function(t,e){this.$set(this.goodsList[e],"goodsId",t.goodsId),this.$set(this.goodsList[e],"goodsName",t.name)},handleSelect:function(t){this.form.customerName=t.memberName,this.form.customerId=t.id},handleSelectCompany:function(t){this.form.companyName=t.name,this.form.companyId=t.id},getTaxRate:function(){var t=this,e={status:"taxRate"};Object(n["M"])(e).then((function(e){var a=e instanceof Array?e:[];t.taxRate=a[0].configValue}))}}},u=r,d=(a("95c3"),a("2877")),m=Object(d["a"])(u,s,l,!1,null,"3a4b0642",null);e["a"]=m.exports},ee6f:function(t,e,a){},f74d:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-selector"},[a("div",{staticClass:"date"},[a("el-select",{ref:"selector",attrs:{placeholder:t.placeholder},on:{change:t.change},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("div",{staticClass:"showDate",style:"width:"+t.width,on:{click:t.dateClick}},[t._v("\n        "+t._s(t.showValue?t.showValue:t.placeholder)+"\n        "),a("span",{staticClass:"unfold-pic"})])])},l=[],i={name:"DateSelector",props:{placeholder:String,options:Array,width:{type:String,default:"83px"}},data:function(){return{value:"",showValue:""}},mounted:function(){},methods:{dateClick:function(){console.log(this.$refs),this.$refs.selector.focus()},change:function(t){console.log(t);for(var e=0;e<this.options.length;e++){var a=this.options[e];if(a.value==t){this.showValue=a.label;break}}this.$emit("change",t)}}},o=i,n=(a("72e4"),a("2877")),c=Object(n["a"])(o,s,l,!1,null,"f8f72a3c",null);e["a"]=c.exports}}]);